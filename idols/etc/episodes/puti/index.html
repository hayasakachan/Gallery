<!doctype html>
<html lang="ja" xml:lang="ja">
<head>
<meta charset="UTF-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="-1">
<meta name="format-detection" content="telephone=no">
<title>アイドルマスター シンデレラガールズ</title>
<link rel="apple-touch-icon-precomposed" href="../../../../idolmaster/image_sp/ui/icon_bookmark.png">
<link rel="stylesheet" type="text/css" href="../../../../idolmaster/css/rich/petit.css" media="all">
<script type="text/javascript">if(window.localStorage){var displaySet=localStorage.getItem('DisplayPositionSet');if(displaySet==1){if(navigator.userAgent.indexOf('Android')>0){document.write('<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">');document.getElementsByTagName('html')[0].style.zoom=document.documentElement.clientWidth/320;}else{document.write('<meta name="viewport" content="width=320, user-scalable=no">');}window.addEventListener('resize',function(){if(navigator.userAgent.indexOf('Android')>0)document.getElementsByTagName('html')[0].style.zoom=document.documentElement.clientWidth/320;});}else{document.write('<meta name="viewport" content="width=device-width, user-scalable=no">');}}else{document.write('<meta name="viewport" content="width=device-width, user-scalable=no">');}</script>
<script src="../../../../idolmaster/js/jquery-1.9.1.min.js"></script>
<script src="../../../../idolmaster/js/jquery.common-popup.js"></script>
<script src="../../../../idolmaster/js/petit_base.js"></script>
<script src="../../../../idolmaster/js/underscore-min.js" type="text/javascript"></script>
<script src="../../../../idolmaster/js/i_base.js" type="text/javascript"></script>
<script src="../../../../idolmaster/js/petit_common.js" type="text/javascript"></script>
<script src="../../../../idolmaster/js/common_new.js" type="text/javascript"></script>
<script src="../../../../idolmaster/js/pex_common.js" type="text/javascript"></script>
<script>
$(document).ready(function(){
  if (typeof newrelic === 'object' && typeof newrelic.setPageViewName === 'function') {
    newrelic.setPageViewName('/idolmaster/index.php/petit_cg');
  }
});
</script>
<script type='text/javascript'>var se_flg = 0, bgm_flg = 0, chrome_app_flg = 0, chrome_app_extension_id = 'dnacabmnfmejgfffmcehejcmiciinpej';</script><script type='text/javascript' src='../../../../idolmaster/js/app_sound.js'></script><link rel="stylesheet" type="text/css" href="../../../../css/base.css" /></head>
<body id="petit_cg">
<div id="top" class="page_container">
<style>
@media only screen and (-webkit-min-device-pixel-ratio: 1.5) {
.animation > canvas { zoom: 50%; }
}
.animation{
position: absolute;
}
</style>
<section id="main_screen" style='position:relative; height:713px;'>
<div id="head_menu">
<ul class="jsOnBtn">
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fmypage%3Fl_frm%3DPetit_cg_index_1%26rnd%3D698924015' class="head_menu_01 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D1%26l_frm%3DPetit_cg_index_1%26rnd%3D633562375' class="head_menu_02 jsLinkAct se_022" data-text="1"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D2%26l_frm%3DPetit_cg_index_1%26rnd%3D994718597' class="head_menu_03 jsLinkAct se_022" data-text="2" id='link-petit-lesson'><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_1%26rnd%3D203822974' class="head_menu_04 jsTech_boardLink se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D4%26l_frm%3DPetit_cg_index_1%26rnd%3D14604462' class="head_menu_05 jsLinkAct se_022" data-text="4" id='link-petit-profile'><div></div></a></li>
<li><a href="#" class="head_menu_06 mainPopUpMenu_btn se_007"><div></div></a></li>
</ul>
</div>
<div id="jsEyeCatch">
<div style="margin-top:100px"><img src='../../../../idolmaster/image_sp/petit_cg/ui/sprite/loading/working_1.gif' width="195" height="139"></div>
<div style="margin-top:-80px"><img src='../../../../idolmaster/image_sp/petit_cg/ui/sprite/loading/loading.gif' width="102" height="102"></div>
</div>
<div style="-webkit-border-bottom-left-radius: 8px; -webkit-border-bottom-right-radius: 8px; position: absolute; top: 0; overflow: hidden; height: 100%;">
<img src='../../../../idolmaster/image_sp/petit_cg/ui/bg/1/long/1.jpg' width="320" height="575" id="animation_bg" style="display:none;">
</div>
<div class="bg_unit under_header_menu jsAfterUnitName" style="z-index:2;">
Individuals
</div>
<div id="animation_ch3" class="animation pexDom display5"></div>
<div id="animation_ch2" class="animation pexDom display5"></div>
<div id="animation_ch1" class="animation pexDom display5"></div>
<div id="animation0" class="animation pexDom display1"></div>
<div id="animation1" class="animation pexDom display2"></div>
<div id="animation2" class="animation pexDom display3 display4"></div>
<input id='ftime' type='hidden' value='0'>
<div class="display4" style="height:1px;"></div>
<div id="pex_title">
<div class="title_main display1 display5 pexDom" style="display:none;">
<a href="#" class="hint se_008" data-help-group-name='main'><div></div></a>
</div>
<div class="title_lesson display2 pexDom" style="display:none;">
<a href="#" class="hint se_008" data-help-group-name='lesson'><div></div></a>
</div>
<div class="title_shop display3 pexDom" style="display:none;">
<a href="#" class="hint se_008" data-help-group-name='shop'><div></div></a>
</div>
<div class="title_profile display4 pexDom">
<a href="#" class="hint se_008" data-help-group-name='profile'><div></div></a>
</div>
<div class="title_scout" id="title_scout">
<a href="#" class="hint se_008" data-help-group-name='scout'><div></div></a>
</div>
<div class="title_deck" id="title_deck">
<a href="#" class="hint se_008" data-help-group-name='deck'><div></div></a>
</div>
<div class="title_deck_modify" id="title_deck_modify">
<a href="#" class="hint se_008" data-help-group-name='deck'><div></div></a>
</div>
<div class="title_equipment_top" id="title_equipment_top">
<a href="#" class="hint se_008" data-help-group-name='equipment'><div></div></a>
</div>
<div class="title_union" id="title_union">
<a href="#" class="hint se_008" data-help-group-name='union'><div></div></a>
</div>
<div class="title_gacha" id="title_gacha">
<a href="#" class="hint se_008" data-help-group-name='gacha'><div></div></a>*
</div>
<div class="title_idol_list" id="title_idol_list" >
<!--a href="#" class="hint"><div></div></a-->
</div>
<div class="title_closet" id="title_closet" >
<a href="#" class="hint se_008" data-help-group-name='closet'><div></div></a>
</div>
<div class="title_help" id="title_help">
<!--a href="#" class="hint"><div></div></a-->
</div>
<div class="title_all_disposal" id="title_all_disposal">
</div>
  <div class="title_snap" id="title_snap">
    <a href="#" class="hint se_008" data-help-group-name='snap'><div></div></a>
  </div>
<script>
$(document).ready(function(){
  var petitHelp = new PetitCommon.PetitHelp();
  var touchBlinker = new IBase.TouchBlinker();
});
</script>
<!-- help -->
<script type='javascript/template' data-help-modal="ぷちデレラについて" data-help-modal-group-name='main'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>プロデューサーとして、ぷちデレラにぷちレッスンやコーディネートを行い、プロデュースしていきます。</p>
        <p>プロデュースで何か分からないことがあったら、ヘルプで確認しましょう！</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_1%3Fl_frm%3DPetit_cg_index_1%26rnd%3D366165224';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷちレッスンについて" data-help-modal-group-name='lesson'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>ぷちデレラにぷちレッスンをさせると、ぷちExpとテクニカルptを獲得することができます。</p>
        <p>ぷちレッスンには、ベースレッスンとテクニカルレッスンがあり、ベースレッスンはぷちExp、テクニカルレッスンはテクニカルptが獲得しやすくなっています。</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_6%3Fl_frm%3DPetit_cg_index_1%26rnd%3D304134441';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷちショップについて" data-help-modal-group-name='shop'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>ぷちショップでは、LIVEバトル等で獲得できるぷちマニーを使ってぷち衣装を購入することができます。</p>
        <p>ぷち衣装を購入することで、ヘアスタイルが解放される場合もありますよ。</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_4%3Fl_frm%3DPetit_cg_index_1%26rnd%3D262407031';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷちプロフについて" data-help-modal-group-name='profile'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>コーディネートやヘアスタイルの変更、解放したぷちエピソードを見ることができますよ。</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_2%3Fl_frm%3DPetit_cg_index_1%26rnd%3D852182959';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷちデレラ養成所について" data-help-modal-group-name='scout'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>スカウトメダルを使ってぷちデレラをスカウトすることができます。</p>
        <p>スカウトメダルはぷちマニー交換等で獲得することができますよ。</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_8%3Fl_frm%3DPetit_cg_index_1%26rnd%3D201014036';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷちデレラ編成について" data-help-modal-group-name='deck'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>ぷちデレラを編成することができます。</p>
        <p>育成編成したぷちデレラは、ぷちレッスン等を実行できるようになります。</p>
        <p>LIVEバトル編成したぷちデレラは、LIVEバトルに参加してくれますよ！</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_5%3Fl_frm%3DPetit_cg_index_1%26rnd%3D435567219';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷち衣装について" data-help-modal-group-name='equipment'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>ぷち衣装をぷちデレラに設定することで、ぷちデレラのアピール力がアップします。</p>
        <p>さらに、メインに設定されたぷち衣装はスキル効果を発揮しますよ！</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_3%3Fl_frm%3DPetit_cg_index_1%26rnd%3D777713458';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷち衣装グレードアップについて" data-help-modal-group-name='union'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>グレードアップを行うことでぷち衣装のパラメータをアップすることができます。</p>
        <p>ぷち衣装は最大で2回までグレードアップさせることができますよ！</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_3%3Fl_frm%3DPetit_cg_index_2%26rnd%3D165442812';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷち衣装ガチャについて" data-help-modal-group-name='gacha'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>ぷち衣装ガチャを引くことで、ぷち衣装を獲得することができます。</p>
        <p>ぷち衣装ガチャは、ぷちマニーを消費することで行えますよ。</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_3%3Fl_frm%3DPetit_cg_index_3%26rnd%3D768388002';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="クローゼットについて" data-help-modal-group-name='closet'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
      <p>所持しているぷち衣装を預けたり、預けたぷち衣装を取り出したりすることができます。</p>
<p>クローゼットには最大1500個のぷち衣装を預けることができますよ。</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_12%3Fl_frm%3DPetit_cg_index_1%26rnd%3D196015280';">
    </div>
  </div>
</script>
<script type='javascript/template' data-help-modal="ぷちスナップについて" data-help-modal-group-name='snap'>
  <div class='p-tutorial-modal'>
    <div class='p-tutorial-modal__inner'>
      <div>
        <div class='p-tutorial-modal__chara'></div>
      </div>
      <div class='p-tutorial-modal__content'>
        <p>背景にぷちデレラを設定して、写真を撮影することができます。</p>
        <p>撮影した写真はTwitterに投稿することができますよ！</p>
        <p>表情やポーズは設定する場所によって変わりますよ！</p>
      </div>
    </div>
    <div class='p-help-modal__help-detail se_022'
         data-touch-blink-class='p-help-modal__help-detail-gray'
         onclick="window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fadvise%2Findex%2Fpetit_13%3Fl_frm%3DPetit_cg_index_1%26rnd%3D386739226';">
    </div>
  </div>
</script>
</div>
<div id="zoom_btn_area" class="display3 display4 pexDom jsOnBtn">
<a href="#" class="zoom_up_btn se_007" data-text='zoom_in' ><div></div></a>
<a href="#" class="zoom_down_btn se_007" data-text='zoom_out'><div></div></a>
</div>
<div id="top_param" class="display1 display5 pexDom">
<dl>
<dt class="money"><span></span></dt>
<dd id="jsUserParam_money"></dd>
</dl>
<dl>
<dt class="point"><span></span></dt>
<dd id="jsUserParam_tcpt"></dd>
</dl>
</div>
<div id="top_like" class="display1 display5 pexDom jsOnBtn">
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Flike_list%3Fl_frm%3DPetit_cg_index_1%26rnd%3D519280615' class="likeBtn">
<div class="total_like"><span class="val">0</span></div>
</a>
</div>
<a href="#" id='use_item_btn' class="index_item_btn pexDom display2"><div></div></a>
<div id="petit_next_lv" class="display2 pexDom">
<dl>
<dt class="next_lv_up"><span></span></dt>
<dd id="jsNextLvUp"></dd>
</dl>
</div>
<div id="lesson_menu" class="display2 pexDom" style="display:none">
<div class="in_block">
<div class="item_list" id="jsLessonList">
<div class="red t-Cnt lesson_efficiency" style="padding-top:7px;display:none">
ぷちレッスン効率<span class='efficiency'></span>%アップ！<br />
</div>
<ul class="jsOnBtn">
</ul>
</div>
</div>
</div>
<div id="lesson_panel" class="jsPopWindow pexDom jsPopUp">
<div class="window_title" id="jsLessonName">ぷちレッスン中</div>
<div class="in_block no-border">
<div class="lessonning">
<div class="time_limit">残り <span id="jsLessonRemainingTime">00:00:00</span><p class="time_icon"></p></div>
<div class="red t-Cnt lesson_efficiency">
ぷちレッスン効率<span class='efficiency'></span>%アップ！<br />
</div>
</div>
</div>
<div class="btn_area jsOnBtn" style="margin-bottom:5px">
<a href="#" class="lesson_stop_btn se_022" id="jsLessonStop"><div></div></a>
<a href="#" class="lesson_reward_btn se_117" id="jsLessonReward"><div></div></a>
<a href="#" class="lesson_levelup_btn se_017" id="jsLessonlevelUp"><div></div></a>
</div>
</div>
<div id="lesson_stop_comp_panel" class="jsPopUp">
<div class="jsPopWindow">
<div class="window_title">ぷちレッスンを中止しました</div>
<a href='#' class='close_btn jsLessonMenuBtnNew se_008'><div></div></a>
<div class="jsOnBtn">
<a href="#" class="jsEtcLessonBtn jsLessonMenuBtnNew se_022"></a>
<a href="#" class="jsToTopBtn jsLinkAct se_022" id="lesson_stop_comp_panel_cls" data-text="1"></a>
</div>
</div>
</div>
<a href="#" class="lesson_stop_comp_panel_btn" style="display:none"></a>
<a href="#" class="lesson_stop_comp_panel_close" style="display:none"></a>
<div id="jsLessonConfirm" class="jsPopUp" style="display:none">
</div>
<a href="#" class="jsLessonConfirm_btn" style="display:none"></a>
<div id="jsLessonComplete" class="jsPopUp" style="display:none">
<div class="jsPopWindow">
</div>
</div>
<a href="#" class="jsLessonComplete_btn" style="display:none"></a>
<a href="#" class="jsLessonComplete_close" style="display:none"></a>
<input type="hidden" name="item_id" value="" id="item_id_at_item_select">
<div id="jsItemPopup" class="jsPopUp" style="display:none">
<div id="jsItemTop"></div>
<div id="jsItemConf"></div>
<div id="jsItemRes"></div>
</div>
<a href="#" class="jsItemPopup_btn" style="display:none"></a>
<a href="#" class="jsItemPopup_close" style="display:none"></a>
<div id="petit_money" class="display3 pexDom">
<dl>
<dt class="money"><span></span></dt>
<dd id="shop_after_money"></dd>
</dl>
</div>
<div id="shop_menu" class="display3 pexDom" style="display:none">
<div class="select_area">
<div class="form_area">
<form action="#" name="form1" method="post">
<select name="item" id="jsShopSort">
<option value="0" style="font-size:1.0rem">全て</option>
<option value="2" style="font-size:1.0rem">コスチューム</option>
<option value="3" style="font-size:1.0rem">ヘッドアクセサリ</option>
<option value="4" style="font-size:1.0rem">ハンドアクセサリ</option>
<option value="5" style="font-size:1.0rem">レッグアクセサリ</option>
</select>
</form>
</div>
<div class="jsOnBtn param_switch_area">
<a href="#" id="jsParamSwitch" class="param_switch se_008"><div></div></a>
</div>
</div>
<div class="in_block area-slide flagAndroid">
<div class="item_list move-area flagAndroid" id="jsShopList">
<ul class="jsOnBtn">
</ul>
</div>
</div>
</div>
<div class="pexDom jsPopUp" id="jsShopConfirm">
</div>
<a href="#" class="jsShopConfirm_btn" style="display:none"></a>
<div id="profile_panel" class="display4 pexDom" style="display:none">
<div class="menu_tab">
<ul>
<li><a href="#" id="jsCoordinate" class="tab_menu_01 _on se_005" name="area_tab_1"><div></div></a></li>
<li><a href="#" id="jsHair" class="tab_menu_02 se_005" name="area_tab_2"><div></div></a></li>
<li><a href="#" id="jsEpisode" class="tab_menu_03 se_005" name="area_tab_3"><div></div></a></li>
<li><a href="#" id="jsComments" class="tab_menu_04 se_005" name="area_tab_4"><div></div></a></li>
</ul>
</div>
<div id="profile_coordinate" class="jsTabArea area_tab_1">
<div class="in_block no-border area-slide flagAndroid" style="height: 216px; position: relative;">
<div class="select_area">
<div class="form_area">
<form action="#" name="form1" method="post">
<select name="item" id="jsCoordinateSort">
<option value="0" style="font-size:1.0rem">全て</option>
<option value="2" style="font-size:1.0rem">コスチューム</option>
<option value="3" style="font-size:1.0rem">ヘッドアクセサリ</option>
<option value="4" style="font-size:1.0rem">ハンドアクセサリ</option>
<option value="5" style="font-size:1.0rem">レッグアクセサリ</option>
</select>
</form>
</div>
<div class="jsOnBtn param_switch_area">
</div>
</div>
<div class="area-slide flagAndroid" style="height: 186px; position: relative; overflow: hidden;">
<div class="item_list move-area flagAndroid" id="jsCoordinateList" style="height: auto;min-height: 186px;position: absolute;overflow: auto;">
<ul>
</ul>
</div>
</div>
</div>
<div class="btn_area" style="margin:6px 24px 0">
<div class="left_area">
<a href="#" class="put_back_btn se_083"><div></div></a>
</div>
<div class="right_area">
<a href="#" id="jsCoordinateChange" class="chenge_btn se_022"><div></div></a>
</div>
</div>
<div class="btn_area t-Cnt" style="margin-top:2px;margin-bottom:3px">
<a href="#" class="btn_current_coordinate jsCoordinateDefaultWindow_btn se_083" id="jsCoordinateDefaultWindow_area" style="margin-bottom:3px"><div></div></a>
</div>
</div>
<div id="profile_hair" class="jsTabArea area_tab_2" style="display:none">
<div class="in_block area-slide flagAndroid" style="height: 216px; position: relative;">
<div class="area-slide flagAndroid" style="height: 186px; position: relative; overflow: hidden;">
<div class="item_list move-area flagAndroid" id="jsHairstyleList" style="height: auto; min-height: 186px; position: absolute;overflow: auto;">
<ul>
</ul>
</div>
</div>
</div>
<div class="btn_area">
<a href="#" id="jsHairstyleChange" class="chenge_btn se_022" style="margin:0 auto"><div></div></a>
</div>
</div>
<div id="profile_episode" class="jsTabArea area_tab_3" style="display:none">
<div class="in_block area-slide flagAndroid" style="height: 262px; position: relative;">
<div class="voice_check_area">
<form name="voice_form" style="display:none" id="petitEpisodeVoiceFlg">
<div class="left_area">
<input type="checkbox" value="1" name="voice_check" id="jsEpisodeVoiceFlag" class="se_008">
</div>
<div class="right_area">
エピソードでボイスを再生させる。
</div>
</form>
</div>
<div class="area-slide flagAndroid" style="height: 232px; position: relative; overflow: hidden;">
<div class="item_list move-area flagAndroid" id="jsEpisodeList" style="height: auto; min-height: 232px; position: absolute;overflow: auto;">
<ul class='ep_list'>
</ul>
</div>
</div>
</div>
</div>
<div id="profile_comments" class="jsTabArea area_tab_4" style="display:none">
<div class="in_block area-slide flagAndroid" style="height: 262px; position: relative;">
<ul class="comments_tabs" style="margin-top: 6px;">
<li class="tab_comm tab_comm_top selected" name="tab_comm_top" data-key="top"></li><li class="tab_comm tab_comm_lesson" name="tab_comm_lesson" data-key="lesson"></li><li class="tab_comm tab_comm_shop" name="tab_comm_shop" data-key="shop"></li><li class="tab_comm tab_comm_coor" name="tab_comm_coor" data-key="coordinate"></li><li class="tab_comm tab_comm_tech" name="tab_comm_tech" data-key="tech_board"></li>
</ul>
<div class="select_area">
<div class="form_area">
<form action="#" name="form1" method="post">
<select name="item" id="jsCommentSort">
</select>
</form>
</div>
</div>
<div class="area-slide flagAndroid" style="height: 186px; position: relative; overflow: hidden;">
<div class="item_list move-area flagAndroid jsCommentList" id="" style="min-height: 186px; height: auto;position: absolute;overflow: auto;">
</div>
</div>
</div>
</div>
<script>
var comment_list = null;
var petit_attribute = null;
var attributes = {
  1 : 'cute'
, 2 : 'cool'
, 3 : 'passion'
}
var $tab_el = $('#profile_comments .comments_tabs');
var $sort_el = $('#profile_comments .select_area');
var $sort_list       = $('#jsCommentSort');
var $comment_list    = $('.jsCommentList');
var $comment_title   = $('.comment_title');
var $comment_wrapper = $('.comment_frame_wrapper');
var $no_comment      = $('.jsNoComments');
$tab_el.hide();
$sort_el.hide();
var sortList_format   = '<option>XX_STR_XX</option>';
var c_title_format    = '<p class="comment_title">XX_STR_XX</p>';
var c_contents_format = '<p class="comment_frame">XX_STR_XX</p>';
$('.tab_comm').on('click', function(){
updateCommentList.comment_category = $(this).data('key');
updateCommentList.init();
});
$('#jsCommentSort').change(function(){
updateCommentList.comment_level = $(this).val();
updateCommentList.viewCommentList();
});
var updateCommentList = {
  comment_category: 'top'
, comment_level:    '1_10'
, comment_list : comment_list
, current_list: {}
, is_no_comments:   0
, attribute : petit_attribute
, init: function(){
$sort_list.empty();
$comment_list.empty();
$tab_el.hide();
$sort_el.hide();
$no_comment.hide();
if(this.comment_list.length == 0){
this.viewNoComments();
return false;
}else{
this.viewSortList();
this.viewCommentList();
}
}
, viewSortList: function(){
$tab_el.show();
$sort_el.show();
$no_comment.hide();
var count = 0;
this.current_list = this.comment_list[this.comment_category]['sub_infos'];
$.each(this.current_list, function(level){
// タブ切り替え時に初期化のために、最初のキー格納
if(count < 1){
updateCommentList.comment_level = level;
}
count++;
// Lv切り替えのselectbox更新
var _sortList_format = '';
if(level == '1_30'){
_sortList_format = sortList_format.replace('XX_STR_XX', '各Lv共通');
}else{
var _level = level.replace('_', '～');
_sortList_format = sortList_format.replace('XX_STR_XX', 'Lv.'+_level+'限定');
}
$(_sortList_format)
.val(level)
.appendTo($sort_list);
});
}
, viewCommentList: function(){
var self = this;
$comment_list.empty();
$comment_list.css('top', 0);
var list = this.current_list[this.comment_level];
if(list){
$.each(list, function(label, args){
if(args.infos){
$.each(args.infos, function( key, texts ){
// 見出し整形・描画
var _key           = key.replace('_', '～');
var comment_title  = !(key.match(/11_30/)) ? args.name : args.name + '(Lv' + _key + ')';
var _comment_title = c_title_format.replace('XX_STR_XX', comment_title);
$(_comment_title)
.addClass('_' + attributes[self.attribute])
.appendTo($comment_list);
// コメントリスト整形・描画
var $comment_wrapper  = $('<div />').addClass('comment_frame_wrapper').addClass('_' + attributes[self.attribute]);
$.each(texts, function( key, value ){
var _comment_contents = c_contents_format.replace('XX_STR_XX', value);
$(_comment_contents).appendTo($comment_wrapper);
$comment_wrapper.appendTo($comment_list);
});
});
}
});
}
}
, viewNoComments: function(){
$('<p class="jsNoComments red" style="margin-left:6px; margin-top: 32px; padding-right: 18px;">Lv30、かつテクニカルボードを全て開放すると閲覧できるようになります。</p>')
.appendTo($comment_list);
}
};
if(updateCommentList.comment_list){
updateCommentList.init();
}else{
updateCommentList.viewNoComments();
}
</script>
</div>
<div class="jsPopWindow jsTabArea area_tab_1 display4 pexDom" style="margin-top:652px;display:none" id="jsCoordinateUnderWindow">
<div class="window_title">ぷち衣装設定でアピールアップ</div>
<div class="in_block no-border">
<div class="frequent_text_area">
ぷち衣装設定でぷちデレラのアピール力をアップさせましょう。
</div>
</div>
<div class="response_area jsOnBtn">
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_2%26rnd%3D35038627' class="equipment_go_btn jsEquipmentLink se_022"><div></div></a>
<div style="color:#ff3333;font-size:12px;text-align:left;padding:0 24px;">※コーディネートではぷちデレラのアピール力はアップしません。</div>
</div>
</div>
<div id="jsCoordinateDefaultWindow" class="jsPopUp"><div class="jsPopWindow"><div class="window_title">現在のコーディネート</div><a href="#" class="close_btn jsCoordinateDefaultWindow_close se_009"><div></div></a><div class="in_block no-border coordinate_default_list" style="padding:8px 0 0;color:#1d1d1d" id="jsCoordinateDefaultArea"><ul></ul></div></div></div>
<div id="jsCompleteWindow" class="jsPopUp">
<div class="jsPopWindow">
<div class="window_title">変更結果</div>
<a href="#" class="close_btn jsCompleteWindow_close se_009"><div></div></a>
<div class="in_block no-border t-Cnt" style="padding:8px 0;color:#1d1d1d">
<span id="completeKind"></span>を変更しました
</div>
<div class="response_area" style="border:none">
<a href='#' class="width_close_btn jsCompleteWindow_close se_009"><div></div></a>
</div>
</div>
</div>
<a href='#' class="jsCompleteWindow_btn" style="display:none"></a>
<div class="fukidashi_inlineWrap display3 display4 pexDom jsFukidashiColor">
<span class="jsIdolMes"></span>
</div>
<div class="fukidashi_inlineWrap display2 pexDom jsFukidashiColor">
<span class="jsIdolMes"></span>
</div>
<div class="fukidashi_inlineWrap display1 pexDom jsFukidashiColor" style="top: 230px; left: 5px;">
<div class="jsFukidashi">
<p id="jsIdolCommentMain"></p>
</div>
</div>
<div class="change-area display1 display5">
<div class='view-change-area display1 display5'>
<div class='view__bg'>
<div class='view__inner'>
<div class='view__left'><a class='jsLinkAct se_022' href='#' data-text='1'><div id='view__left' class='view__icon-selected'></div></a></div>
<div class='view__right'>
<a class='jsLinkAct se_022' href='#' data-text='5'><div id='view__right' class=' view__icon-unselected'></div></a>
</div>
</div>
</div>
</div>
<div class='chara-change-area display1'>
<div class='cc__bg'>
<div class='cc__inner'>
<div class='cc__left'><div id='cc-left' class='cc__icon-unselected' data-type='3'></div></div>
<div class='cc__center'><div id='cc-center' class='cc__icon-unselected' data-type='1'></div></div>
<div class='cc__right'><div id='cc-right' class='cc__icon-unselected' data-type='2'></div></div>
</div>
</div>
</div>
</div>
<span class="jsOnBtn">
<a href="#" class="index_visit_btn jsVisit_btn pexDom display1 display5"><div></div></a>
<a href="#" id='index_action_btn' class="index_action_btn _off pexDom display1 display5"><div></div></a>
</span>
<div class="index_menu_area pexDom display1 display5">
<ul class="jsOnBtn">
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D2%26l_frm%3DPetit_cg_index_2%26rnd%3D222130445' class="index_menu_bt_01 jsLinkAct se_022" data-text="2"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_3%26rnd%3D434378238' class="index_menu_bt_02 jsTech_boardLink se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D3%26l_frm%3DPetit_cg_index_1%26rnd%3D903848776' class="index_menu_bt_03 jsLinkAct se_022" data-text="3"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fdeck_edit_top%3Fl_frm%3DPetit_cg_index_1%26rnd%3D419090767' class="index_menu_bt_04 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_4%26rnd%3D394989176' class="index_menu_bt_05 jsEquipmentLink se_022"><div></div></a></li>
</ul>
</div>
</section>
<div class="display2 pexDom gray lesson_efficiency" style="display:none;padding:0 10px;margin-top:-7px;display:none">
※開催期間中にレッスン完了ボタンを押したぷちレッスンが効率アップの対象となります。
</div>
<a href='#' id='end_load' style='display:none;'></a>
<script src='../../../../idolmaster/js/pex_json/02_change_cloth_motion.js'></script>
<script src="../../../../idolmaster/js/pex-petit-1.2.0.js" type="text/javascript"></script>
<section style="margin-bottom:0">
<div class="line_type01"></div>
<div class="gray infortext t-Lft">
<p>※推奨環境は以下になります。<br>
iPhone 5 以降 かつ iOS 8.0 以上の端末<br>
Android 4.2 以上搭載の端末
</p>
<p>※タブレットを含む一部非対応の端末もございます。</p>
<p>※推奨環境であっても一部端末で動作しない場合がございます。</p><p>※いいね!された回数は、毎週月曜0時にリセットされます。</p>
</div>
<div class="line_type01"></div>
</section>
<div id="jsVisit" class="jsPopUp" style="display:none">
<div class="jsPopWindow">
<div class="window_title" style="font-size:12px;">他プロデューサーのぷちデレラを訪問します</div>
<a href="#" class="close_btn jsVisit_close"><div></div></a>
<div class="in_block no-border">
<div class="index_visit_btn_area displayBox jsOnBtn">
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fpetit_cheer%2F112024860%3Frnd_all%3D1%26l_frm%3DPetit_cg_index_1%26rnd%3D699449946' class="button_top_menu_visit_01"></a>
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fpetit_cheer%2F1196262%3Frnd_prd%3D1%26l_frm%3DPetit_cg_index_1%26rnd%3D34110718' class="button_top_menu_visit_02"></a>
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fknights%2Fknights_member%3Fl_frm%3DPetit_cg_index_1%26rnd%3D457322798' class="button_top_menu_visit_03"></a>
</div>
</div>
</div>
</div>
<a href="#" class="jsVisit_close" style="display:none"></a>
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fmypage%3Fl_frm%3DPetit_cg_index_2%26rnd%3D933662151'><div class="backLink">マイスタジオへ</div></a>
<script type="text/javascript">
var loading = { 'main' : false , 'window' : false , 'lesson' : false };
var main_json = document.createElement('script');
var lesson_json = document.createElement('script');
var character = new Object();
//var cloth_data = new Object();
var menu = false;
var timer = false;
var zoom = true;
var cloth_ready = true;
var change_click = false;
//var now_loading = false;
var $animation = $('.animation');
var $ftime = $('#ftime');
var eyeCatch = new EyeCatch();
var currentCharacter = new CurrentCharacter();
var chara = function(){ return currentCharacter.get(); };
var lesson_flag = new Array();
var catch_list = new Object();
var stage = [];
stage[1] = $('.display1');
stage[2] = $('.display2');
stage[3] = $('.display3');
stage[4] = $('.display4');
stage[5] = $('.display5');
var type_keys = ['expression' , 'hair' , 'costume' , 'head', 'hand', 'leg'];
var motion_list = $.parseJSON('{"1":["2","1","3"]}');
main_json.onload = function(){
loading.main = true;
firstLoaded();
};
lesson_json.onload = function(){
loading.lesson = true;
firstLoaded();
};
main_json.src = "../../../../idolmaster/js/pex_json/05_top_petit.js";
lesson_json.src = "../../../../idolmaster/js/pex_json/01_main_motion.js";
document.getElementsByTagName('head')[0].appendChild(main_json);
document.getElementsByTagName('head')[0].appendChild(lesson_json);
function afterLevelUp(){
$ftime.trigger('change');
}
function afterAppendMotion (pos){
setTimeout(function(){
mc.character[pos?pos:chara()].api.callActions('/','init');
eyeCatch.offMotion();
},300);
}
$(function(){
window.screenRefresh = function(num){ if(is_null(num)){ screenChange( menu.getNow() ,true); }else{ screenChange( num ); } }
var userData = [];
var se_play_flg = 1;
userData.money = 0;
var nowPositionId = [];
nowPositionId[1] = 1070;
nowPositionId[2] = 1109;
nowPositionId[3] = 1092;
var lessonCampaignFlg = 0;
var onload_time = 1679322182,
delay_time = 0;
$('#jsShopConfirm').ou();
$('#jsLessonConfirm').ou();
$('#lesson_stop_comp_panel').ou();
$('#jsLessonComplete').ou();
$("#jsCoordinateDefaultWindow").ou();
$("#jsCompleteWindow").ou();
$("#jsVisit").ou();
$('#jsParamSwitch').on('click', function(){
var palam = [ $('.palamCls'), $('.palam'), $('.palam2'), $('.palam3'), $('.palam4') ];
palam[0].hide();
if(peNo++ > 3) peNo = 1;
palam[peNo].show();
return false;
});
var peNo = 1;
$('.jsLinkAct').on('click', function(){
var num = $(this).data('text');
if(window.localStorage){
if(num == 1){
if( $(this).hasClass('head_menu_02') ){
if (localStorage.getItem("unitView") == "1" && Object.keys(mc.character).length >1){
num = 5;
}else{
num = 1;
localStorage.setItem("unitView", 0);
}
}else{
localStorage.setItem("unitView", 0);
}
}else if (num == 5){
localStorage.setItem("unitView", 1);
}
}
screenChange( num );
$('#jsIdolCommentMain').empty();
$('.jsIdolMes').empty();
return false;
});
function screenChange(no, first){
now_loading = true;
setTimeout(function(){
menu.setNow(no);
canvas_now = menu.canvasNum();
if (no == 4){
mc.character[chara()].fitting = { hair : 0 , costume : 0 , head : 0 , hand : 0 , leg : 0 };
mc.character[chara()].fit_sub_type = new Object();
mc.character[chara()].sub_flag = 0;
$.extend( mc.character[chara()].fit_sub_type , mc.character[chara()].take_sub_type );
}else{
for (var i in mc.character){
delete mc.character[i].fitting;
}
}
if(menu.getNow()!=no) {
zoom = true;
}
var $zoom = $('#zoom_btn_area');
if(zoom){
$zoom.find('.zoom_up_btn').hide();
$zoom.find('.zoom_down_btn').show();
}else{
$zoom.find('.zoom_down_btn').hide();
$zoom.find('.zoom_up_btn').show();
}
var cc_icon = { '1' : 'center' , '2' : 'right' , '3' : 'left' };
for(var cc=1; cc<=Object.keys(cc_icon).length;cc++ ){
if( $('#cc-'+cc_icon[cc]).hasClass('cc__icon-none') ) continue;
if(parseInt(cc) == chara()){
$('#cc-'+cc_icon[cc]).removeClass().addClass('cc__icon-selected');
}else{
$('#cc-'+cc_icon[cc]).removeClass().addClass('cc__icon-unselected');
}
}
$('.chara-change-area').addClass('solo').show();
$('.view-change-area').hide();
$('#animation_bg').hide();
clearInterval(timer);
var act_btn = $('#index_action_btn');
//TODO カーテンと動きを連動させる
if (no == 2) {
getLessonList(1);
$('#main_screen').css('height','492px').css('background-color','#d0975c');
$('#animation1').css('top','37px');
$('.change-area').css('top','110px');
} else if (no == 3) {
$('.mainPopUpMenu_close').trigger('click');
getShopList();
$('#main_screen').css('height','549px').css('background-color','#fff');
$('.change-area').css('top','123px');
} else if (no == 1 ) {
$('#animation_bg').show();
$('.chara-change-area').removeClass('solo');
$('.view-change-area').show();
getPetitStatus(first);
act_btn.removeClass('unit');
if(typeof motion_list == 'object'){
if(typeof motion_list[chara()]!='undefined'){
act_btn.removeClass('_off');
}else{
if(!act_btn.hasClass('_off')) act_btn.addClass('_off');
}
}
$('#main_screen').css('height','505px').css('background-color','#d0975c');
$('#animation0').css('top','6px');
$('.change-area').css('top','110px');
} else if (no == 5) {
getPetitStatus(first);
act_btn.addClass('unit');
$('#index_action_btn').removeClass('_off');
$('#animation_bg').show();
$('.view-change-area').show();
$('.chara-change-area').hide();
$('#main_screen').css('height','505px').css('background-color','#d0975c');
$('div[id^="animation_ch"]').css('top','27px');
$('.change-area').css('top','110px');
//mc.init();
} else if (no == 4) {
getPetitStatus(first);
if ($('#jsHair').hasClass('_on')) {
getHairstyleList();
} else if ($('#jsEpisode').hasClass('_on')){
getEpisodeList( petitLocalStrageLoad('idol_id') );
} else if ($('#jsComments').hasClass('_on')){
getCommentsList();
} else {
getCoordinateList();
}
if( $('#profile_coordinate').css('display') != 'none' ){
$('#main_screen').css('height','828px').css('background-color','#fff');
}else{
$('#main_screen').css('height','610px').css('background-color','#fff');
}
}
if ( no != 2 ) mc.init();
$('.pexDom').hide();
stage[no].show();
if ($('#jsHair').hasClass('_on') || $('#jsEpisode').hasClass('_on') || $('#jsComments').hasClass('_on')) $('#jsCoordinateUnderWindow').hide();
eyeCatch.setMotion(-1);
}, 300);
$('#jsCoordinateChange').removeData();
var loading_count = 2;
switch(no){
case 1 :
$('#view__left').removeClass().addClass('view__icon-selected');
if (!$('#view__right').hasClass('view__icon-none')) {
$('#view__right').removeClass().addClass('view__icon-unselected');
}
break;
case 4 :
loading_count = 3;
break;
case 5 :
loading_count = Object.keys(mc.character).length;
$('#view__left').removeClass().addClass('view__icon-unselected');
$('#view__right').removeClass().addClass('view__icon-selected');
break;
}
eyeCatch.setCount(loading_count);
}
$.ajaxSetup({
timeout: 10000,
dataType: 'json',
cache: false,
error: function(jqXHR, textStatus, errorThrown) {
reportAjaxError(this.url, this.data, textStatus, errorThrown);
//backProfile();
window.alert("通信に失敗しました。通信環境の良い場所で再度お試しください。");
}
});
function reportAjaxError(url, data, textStatus, errorThrown) {
var error = {
_url: url,
_data: data,
textStatus: textStatus,
errorThrown: errorThrown
};
$.ajax({
type: 'post',
data: $.param(error),
url: '../../../../idolmaster/petit_cg/report_ajax_error',
timeout: 1000,
success: function() { /* 何もしない */ },
error: function() { /* 何もしない */ }
})
}
function getLessonList(sortId){
var temp_id = chara();
var type = (typeof(sortId) !== 'undefined') ? sortId : '1';
var url  = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fexchange%3Fl_frm%3DPetit_cg_index_1%26rnd%3D150012186';
$.ajax({
type: 'POST',
url: url.replace('exchange', 'petit_cg/ajax_lesson_list?rnd='+(Math.floor( Math.random()*1000000))),
dataType: 'json',
headers: {
"Pragma": "no-cache"
},
data: {
"idol_id": petitLocalStrageLoad('idol_id'),
"type": sortId,
"deck_position": temp_id
}
})
.done(function(data) {
nextLevelInput(data.user_lesson.next_exp);
setIdolMes(2,data.idol_message,data.idol_attribute);
lesson_campaign_view(data.lesson_ini.efficiency, data.lesson_ini.from, data.lesson_ini.to, data.user_lesson.state == 2);
if (data.user_lesson.state == 2) {
setLessonRemainingTime(0);
showLessonRewardReceive(data.user_lesson);
mc.character[data.user_lesson.deck_position].lesson = data.user_lesson.attribute;
mc.init(data.user_lesson.deck_position);
} else if (data.user_lesson.state == 1) {
$('#main_screen').css('height','417px').css('background-color','#d0975c');
setLessonRemainingTime(data.user_lesson);
$('#jsLessonConfirm').empty();
createLessonConfirm(data.user_lesson);
showHaveLesson();
$('#jsLessonExec').attr('rel', 2);
mc.character[data.user_lesson.deck_position].lesson = data.user_lesson.attribute;
mc.init(data.user_lesson.deck_position);
} else {
createLessonList(data.lesson_list, data.user_lesson.attribute, data.user_lesson.deck_position);
mc.init(data.user_lesson.deck_position);
}
eyeCatch.offCount();
if(window.lesson_list == void 0){
window.lesson_list = data.lesson_list;
}
});
return false;
}
function lesson_campaign_view(value, start_time, finish_time, lesson_complete_flag){
if(value > 0){
$('.efficiency').text(value);
$('.lesson_efficiency').show();
if(lesson_complete_flag) {
$('#main_screen').css('height','454px').css('background-color','#d0975c');
}
else {
$('#main_screen').css('height','537px').css('background-color','#d0975c');
}
$('#jsLessonList').css('height','222px');
lessonCampaignFlg = 1;
}else{
$('.efficiency').text("");
$('.lesson_efficiency').hide();
if(lesson_complete_flag) {
$('#main_screen').css('height','418px').css('background-color','#d0975c');
}
else {
$('#main_screen').css('height','492px').css('background-color','#d0975c');
}
$('#jsLessonList').css('height','177px');
lessonCampaignFlg = 0;
}
}
function nextLevelInput(exp){
$('#jsNextLvUp').text(exp);
}
function createLessonList(lessons, attribute, deck_position){
var list = $('#jsLessonList > ul');
var showHtml = "<ul class='jsOnBtn'>";
for (var key in lessons) {
var row = lessons[key];
var lesson_type = row.lesson_type == 2 ? 'technical' : 'base';
var tmp = "\
<li>\
<a href='#' class='jsLessonStart' data-lesson_id='"+ row.lesson_id +"' data-point='"+ row.point +"' data-exp='"+ row.exp +"' data-image='"+ row.image +"' data-lesson_name='"+ row.lesson_name +"' data-remaining_time='"+ row.remaining_time +"' data-lesson_type='"+lesson_type+"' data-attribute='"+ attribute +"'>\
<div class='title "+ lesson_type +"'>"+ row.lesson_name +"</div>\
<div class='textarea'>\
"+ row.comment +"\
</div>\
</a>\
</li>\
";
showHtml += tmp;
}
list.replaceWith(showHtml += '</ul>');
$('.jsLessonStart').on('click', function(){
se_play('se_022');
$('#jsLessonConfirm').empty();
createLessonConfirm($(this).data(), deck_position);
return false;
});
}
function createLessonConfirm(data, deck_position){
var deck_position = !is_null(deck_position) ? deck_position : '0';
var path = chooseLessonImage(data.state ? data.attribute :makeLessonAttribute(data.lesson_type == 'base'));
var target = $('#jsLessonConfirm');
var showHtml = "\
<div class='jsPopWindow'>\
<div class='window_title'>"+ data.lesson_name +"を<span id='jsLessonState'>実施</span>しますか？</div>\
<a href='#' class='close_btn jsLessonConfirm_close_sub'><div></div></a>\
<div class='in_block no-border'>\
<div class='contents_confirm'>\
<div class='image_area' style='padding-left:8px'>\
<img src='"+ path +"' width='120' height='100'>\
</div>\
<div class='data_area'>\
<h3>レッスン時間</h3>\
<div class='time'>"+ data.remaining_time +"</div>\
<h3>効果</h3>\
<div class='effect'>\
<span class='blue'>ぷち Exp:</span> <span class='yellow'>+"+ data.exp +"</span><br>\
<span class='blue'>テクニカル pt:</span> <span class='yellow'>+"+ data.point +"</span>\
</div>\
</div>\
</div>\
</div>\
<p style='display:none;' class='red t-Cnt' id='lessonStopText'>※ぷちレッスンを中止すると<br>ぷちExpとテクニカルptは獲得できません。</p>\
<p style='display:none;' class='red t-Cnt' id='lessonCenterText'>センターはぷちレッスン効率20%アップ!</p>\
<div class='response_area jsOnBtn'>\
<div class='left_area'>\
<a href='#' class='jsNotBuyBtn jsLessonConfirm_close'><div></div></a>\
</div>\
<div class='right_area'>\
<a href='#' id='jsLessonExec' class='jsBuyBtn' rel='1' data-lesson_type='"+data.lesson_type+"'><div></div></a>\
</div>\
</div>\
</div>\
";
target.prepend(showHtml);
if (deck_position == 1) {
$('#lessonCenterText').show();
} else {
$('#lessonCenterText').hide();
}
$('#jsLessonName').text(data.name);
$('.jsLessonConfirm_btn').trigger('click');
lessonExec(data);
$('#jsLessonStop').on('click', function(){
$('.jsLessonConfirm_btn').trigger('click');
//$('#jsLessonConfirm').show();
return false;
});
}
function lessonExec(data){
$('#jsLessonExec').on('click', function(){
se_play('se_113');
if( $(this).attr('rel') == 1 ){
se_play_flg = 0;
data.attribute = mc.character[chara()].lesson;// lesson_attribute[chara()];
$('#main_screen').css('height','417px').css('background-color','#d0975c');
lessonStart(data);
}else{
se_play_flg = 0;
lessonStop(data);
mc.character[chara()].stopLesson();
}
lessonAgainData();
return false;
});
$('#jsLessonStop').off('click');
$('#jsLessonStop').on('click', function(){
$('#jsLessonExec').attr('rel', 2);
$('#jsLessonState').text('中止');
//$('.image_area > img').attr('src',chooseLessonImage( character[chara()].lesson ));
$('#lessonStopText').show();
$('#lessonCenterText').hide();
$('#jsLessonConfirm').show();
return false;
});
$('.jsLessonMenuBtnNew').off('click');
$('.jsLessonMenuBtnNew').on('click', function(){
$('.lesson_stop_comp_panel_close').trigger('click');
$('#main_screen').css('height','570px').css('background-color','#d0975c');
$('#lesson_menu').show();
getLessonList(1);
return false;
});
}
function lessonAgainData(){
var data = $('#lesson_menu').data();
if(typeof data != 'object') return false;
var flag = false;
if(Object.keys(data).length){
flag = true;
$('#lesson_menu').removeData();
}
return flag;
}
$('#lesson_stop_comp_panel_cls').on('click', function(){
$('.lesson_stop_comp_panel_close').trigger('click');
});
function lessonStart(data){
$('#jsLessonExec').attr('rel', 1);
showHaveLesson();
var temp_id = chara();
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_start_lesson%3Fl_frm%3DPetit_cg_index_1%26rnd%3D50863168',
dataType: 'json',
data: {
"lesson_id": data.lesson_id,
"deck_position": temp_id,
"attribute" : data.attribute
}
})
.done(function(data) {
mc.character[data.deck_position].lesson = data.attribute;
mc.character[data.deck_position].runLesson();
setIdolMes(2,data.idol_message,data.idol_attribute);
setLessonRemainingTime(data);
$('#main_screen').css('height','408x').css('background-color','#d0975c');
eyeCatch.offCount();
});
}
function lessonStop(data){
var current_chara = chara();
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_cancel_lesson%3Fl_frm%3DPetit_cg_index_1%26rnd%3D731611222',
dataType: 'json',
data: {
"idol_id": petitLocalStrageLoad('idol_id'),
"lesson_id": data.lesson_id,
"deck_position": current_chara
}
})
.done(function(data) {
mc.character[current_chara].lesson = false;
$('#jsLessonExec').attr('rel', 1);
$('.jsLessonConfirm_close').trigger('click');
//$('.jsPopWindow').hide();
$('#lesson_panel').hide();
$('.lesson_stop_comp_panel_btn').trigger('click');
//$('#lesson_stop_comp_panel').show();
});
}
function lessonFinish(data){
var lesson_id = data.lesson_id;
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_finish_lesson%3Fl_frm%3DPetit_cg_index_1%26rnd%3D113470085',
dataType: 'json',
data: {
"idol_id": petitLocalStrageLoad('idol_id'),
"lesson_id": lesson_id,
"deck_position": data.deck_position
}
})
.done(function(data) {
if(data.level_up_flag){
$ftime.data('object',data);
mc.character[data.deck_position].api.callActions('/', 'default_back' );
setTimeout(function(){
mc.character[data.deck_position].api.callActions('/', 'level_up' );
},300);
}else{
showCompleteLesson(data);
mc.character[data.deck_position].stopLesson();
}
var user_lesson = $.extend({}, window.lesson_list[lesson_id]);
user_lesson.state = 0;
user_lesson.lesson_type = user_lesson.lesson_type == 2 ? 'technical' : 'base';
$('#lesson_menu').data(user_lesson);
});
}
function hideLessonList(){
se_play_flg = 0;
$('.jsLessonConfirm_close').trigger('click');
//$('.jsPopWindow').hide();
$('#lesson_menu').hide();
}
function showHaveLesson(){
hideLessonList();
$('#jsLessonReward').hide();
$('#jsLessonlevelUp').hide();
$('#jsLessonStop').show();
$('#lesson_panel').show();
if(lessonCampaignFlg) $('#main_screen').css('height','455px').css('background-color','#d0975c');
}
function showLessonRewardReceive(data){
hideLessonList();
$('#jsLessonStop').hide();
if (data.level_up_flag) {
$('#jsLessonReward').hide();
$('#jsLessonlevelUp').show();
} else {
$('#jsLessonlevelUp').hide();
$('#jsLessonReward').show();
}
$('#lesson_panel').show();
$('#jsLessonReward, #jsLessonlevelUp').off();
$('#jsLessonReward').on('click', function(){
se_play('se_117');
$('#jsLessonReward, #jsLessonlevelUp').off();
lessonFinish(data);
return false;
});
$('#jsLessonlevelUp').on('click', function(){
se_play('se_017');
$('#jsLessonReward, #jsLessonlevelUp').off();
lessonFinish(data);
return false;
});
}
function showCompleteLesson(data){
createLessonResult(data);
$('#lesson_panel').hide();
//$('#jsLessonComplete').show();
$('.jsLessonComplete_btn').trigger('click');
}
function createLessonResult(data){
var path = chooseLessonImage( mc.character[chara()].lesson );
$('#jsLessonComplete > .jsPopWindow').empty();
var target = $('#jsLessonComplete > .jsPopWindow');
var showHtml = "\
<div class='window_title'>レッスン完了</div>\
<a href='#' class='close_btn jsLessonCompBtnParts2'><div></div></a>\
<div class='in_block no-border'>\
<div class='contents_confirm'>\
<div class='image_area'>\
<img src='"+ path +"' width='120' height='100'>\
</div>\
<div class='data_area'>\
<h3>獲得</h3>\
<div class='effect' style='font-weight:normal'>\
<span class='blue'>ぷち Exp:</span> <span class='yellow'>+"+ data.up_exp +"</span><br>\
<span class='blue'>テクニカル pt:</span> <span class='yellow'>+"+ data.up_point +"</span>\
</div>\
";
if(data.level_up_flag) {
showHtml += "\
<h3>Lvアップ</h3>\
<div class='effect' style='font-weight:normal;font-size:11px;color:#2e3d4a'>\
<span class='blue'>Lv:</span>"+ data.level +"/30(<span class='yellow'>+"+ data.up_level +"</span>) <span class='blue'>Vo:</span>"+ data.vo +"(<span class='yellow'>+"+ data.up_vo +"</span>)<br>\
<span class='blue'>Da:</span>"+ data.da +"(<span class='yellow'>+"+ data.up_da +"</span>) <span class='blue'>Vi:</span>"+ data.vi +"(<span class='yellow'>+"+ data.up_vi +"</span>)\
</div>\
";
}
showHtml += "\
</div>\
</div>\
</div>\
<div class='response_area jsOnBtn' style='padding-bottom:0'>\
<div class='jsOnBtn displayBox' style='width:266px; margin: 0 auto 5px;'>\
<a href='#' class='jsEtcLessonBtnSmall jsLessonMenuBtnNew' data-text='2' id='link-petit-lesson'></a>\
<a href='#' class='jsAgainLessonBtn jsLessonAgainMenu'></a>\
</div>\
<div class='jsOnBtn'>\
<a href='#' id='lesson_comp_panel_cls' class='jsToTopBtn jsLinkAct' data-text='1' style='margin-bottom:0'></a>\
</div>\
</div>\
";
target.prepend(showHtml);
$('.jsLessonMenuBtnNew').on('click', function(){
se_play('se_022');
$('.jsLessonComplete_close').trigger('click');
$('#main_screen').css('height','570px').css('background-color','#d0975c');
$('#lesson_menu').show();
getLessonList(1);
return false;
});
$('#lesson_comp_panel_cls').on('click', function(){
se_play('se_022');
$('.jsLessonComplete_close').trigger('click');
screenChange(1);
});
$('.jsLessonCompBtnParts2').on('click', function(){
se_play('se_009');
$('.jsLessonComplete_close').trigger('click');
screenChange(1);
});
//target.replaceWith(showHtml);
}
function setLessonRemainingTime(data){
if (!data || data === '0'){ $('#jsLessonRemainingTime').text('00:00:00'); return; }
$('#jsLessonRemainingTime').text(data.remaining_time);
count_down_timer('#jsLessonRemainingTime',data);
}
function chooseLessonImage(no){
var path = '';
//lesson_attribute[chara()] = no;
mc.character[chara()].lesson = no;
switch(parseInt(no)){
case 1:
path = '../../../../idolmaster/image_sp/petit_cg/ui/etc/lesson_vi.png';
break;
case 2:
path = '../../../../idolmaster/image_sp/petit_cg/ui/etc/lesson_da.png';
break;
case 3:
path = '../../../../idolmaster/image_sp/petit_cg/ui/etc/lesson_vo.png';
break;
default:
path = '../../../../idolmaster/image_sp/petit_cg/ui/etc/lesson_base.png';
break;
}
return path;
}
$('#jsShopSort').on('change', function(){
getShopList($(this).val());
});
function getShopList(sortId){
var type = (typeof(sortId) !== 'undefined') ? sortId : '0';
if (!sortId) {
$('#jsShopSort').val(0);
}
$.ajax({
type: 'POST',
url: '../../../../idolmaster/petit_cg/ajax_exchange_base_data',
dataType: 'json',
data: {
"type": type,
"deck_position": chara()
}
})
.done(function(data) {
createShopList(data.accessory_csv,data.petit_param,data.user_accessory_max_flag);
$('#shop_after_money').text(data.petit_param.money);
setIdolMes(3,data.idol_message,data.idol_attribute);
eyeCatch.offCount();
});
return false;
}
function createShopList(accessorys,userData,buyFlg){
var list = $('#jsShopList > ul');
var showHtml = "<ul>";
for (var key in accessorys) {
var row = accessorys[key];
var str = textCut(row.accessory_name);
var tmp = "\
<li>\
<div class='img_area'><img src='"+ row.image +"' width='40' height='40'></div>\
<div class='param_area'>\
<div class='item_name'>"+ str +"\
<div class='starImg"+ row.rarity +"'></div>\
</div>\
<div class='param_data_area active_skill_palam long' style='width:83px'>\
<dl class='palam palamCls'>\
<dt class='price'><span></span></dt>\
<dd class='jsIdolListPalam_price'>"+ String(row.purchase_price).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') +"</dd>\
</dl>\
<dl class='palam2 palamCls'>\
<dt class='vo'><span></span></dt>\
<dd class='jsIdolListPalam_vo'>"+ row.vo_1 +"</dd>\
</dl>\
<dl class='palam3 palamCls'>\
<dt class='da'><span></span></dt>\
<dd class='jsIdolListPalam_da'>"+ row.da_1 +"</dd>\
</dl>\
<dl class='palam4 palamCls'>\
<dt class='vi'><span></span></dt>\
<dd class='jsIdolListPalam_vi'>"+ row.vi_1 +"</dd>\
</dl>\
</div>\
</div>\
<div class='btn_area jsOnBtn'>\
<a href='#' class='change_cloth_btn'><div></div></a>\
<a href='#' class='item_buy_btn' data-key='"+ key +"' data-type_id='"+row.type_id+"' ><div></div></a>\
</div>\
</li>\
";
showHtml += tmp;
}
if(buyFlg) showHtml += "<input type='hidden' id='jsNotBuyFlg' value='1'>";
else showHtml += "<input type='hidden' id='jsNotBuyFlg' value='0'>";
list.replaceWith(showHtml += '</ul>');
$('.item_buy_btn').on('click', function(){
se_play('se_022');
var key = $(this).data(key);
shopConfirm(userData,accessorys[key["key"]]);
return false;
});
$('.change_cloth_btn').on('click', function(){
se_play('se_008');
var buy_btn = $(this).parent().find('.item_buy_btn');
ajaxChangeCloth( buy_btn.data('key') , buy_btn.data('type_id') );
return false;
});
}
function shopConfirm(userData, accessory){
$('#jsShopConfirm').empty();
var target = $('#jsShopConfirm');
var showHtml = "\
<div class='jsPopWindow'>\
<div class='window_title'>アクセサリを購入しますか？</div>\
<a href='#' class='close_btn jsShopConfirm_close'><div></div></a>\
<div class='in_block no-border item_param_area jsBuyConfView'>\
<div class='shop_item_area'>\
<div class='shop_item_img'>\
<img src='"+ accessory.image +"' width='60' height='60' id='jsShopItemPalam_img'>\
</div>\
<div class='item_data_list'>\
<div class='item_name'><span id='jsShopItemPalam_name' class='jsItemPalam'>"+ accessory.accessory_name +"</span>\
<div class='starImg"+ accessory.rarity +"'></div>\
</div>\
<div class='data_list'>\
<ul>\
<li>\
<dl>\
<dt class='type'><span></span></dt>\
<dd id='jsShopItemPalam_type' class='jsItemPalam' style='font-size:9px'>"+ accessory.type_name +"</dd>\
</dl>\
</li>\
<li>\
<dl>\
<dt class='price'><span></span></dt>\
<dd class='price jsItemPalam' id='jsShopItemPalam_price'>"+ String(accessory.purchase_price).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') +"</dd>\
</dl>\
</li>\
<li class='short'>\
<dl>\
<dt class='vo'><span></span></dt>\
<dd id='jsShopItemPalam_vo' class='jsItemPalam'>"+ accessory.vo_1 +"</dd>\
</dl>\
</li>\
<li class='short'>\
<dl>\
<dt class='da'><span></span></dt>\
<dd id='jsShopItemPalam_da' class='jsItemPalam'>"+ accessory.da_1 +"</dd>\
</dl>\
</li>\
<li class='short'>\
<dl>\
<dt class='vi'><span></span></dt>\
<dd id='jsShopItemPalam_vi' class='jsItemPalam'>"+ accessory.vi_1 +"</dd>\
</dl>\
</li>\
</ul>\
</div>\
</div>\
</div>\
";
if (accessory.skill_name || accessory.skill_effect || accessory.explanation) {
showHtml += "\
<div class='item_data_skill'>\
";
}
if (accessory.skill_name) {
showHtml += "\
<div id='jsSkillWrap'>\
<dl>\
<dt class='skill'><span></span></dt>\
<dd id='jsShopItemPalam_skill' class='jsItemPalam'>"+ accessory.skill_name +"</dd>\
</dl>\
</div>\
";
}
if (accessory.skill_effect) {
showHtml += "\
<div id='jsEffectWrap'>\
<dl>\
<dt class='effect'></dt>\
<dd class='long jsItemPalam' id='jsShopItemPalam_effect'>"+ accessory.skill_effect +"</dd>\
</dl>\
</div>\
";
}
if (accessory.explanation) {
showHtml += "\
<div class='text_area'>"+ accessory.explanation +"</div>\
";
}
if (accessory.skill_name || accessory.skill_effect || accessory.explanation) {
showHtml += "\
</div>\
";
}
showHtml += "\
</div>\
";
if ( $('#jsNotBuyFlg').val() == 1 ) {
showHtml += "\
<div class='response_area jsOnBtn'>\
<div class='red'>\
ぷち衣装所持上限に達しているため、<br>購入できません\
</div>\
<a href='#' class='close_window_btn' id='jsCloseWindowBtn'><div></div></a>\
</div>\
</div>\
";
} else if (parseInt(accessory.purchase_price) <= parseInt(userData.money)) {
showHtml += "\
<div class='response_area jsOnBtn jsBuyConfView'>\
\
<div class='param_type_01 long'>\
<dl>\
<dt class='item_possession'><span></span></dt>\
<dd>"+ accessory.has_cnt +"</span></dd>\
</dl>\
</div>\
<div class='param_type_01 long'>\
<dl>\
<dt class='confirm_money'><span></span></dt>\
<dd id='jsUseMoney'>"+ String(userData.money).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') +"</span> ⇒ <span class='red'><span id='afterMoney'>"+ String(parseInt(userData.money) - parseInt(accessory.purchase_price)).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,') +"</span></dd>\
</dl>\
</div>\
<div class='left_area'>\
<a href='#' class='jsNotBuyBtn jsShopConfirm_close'><div></div></a>\
</div>\
<div class='right_area'>\
<a href='#' id='jsBuyBtn' class='jsBuyBtn'><div></div></a>\
</div>\
</div>\
<div class='response_area jsOnBtn jsBuyCompView' style='display:none'>\
<p style='padding: 5px; color:black; display:none;' id='after_buy_message'></p>\
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D3%26l_frm%3DPetit_cg_index_2%26rnd%3D49525556' class='buy_continue_btn'><div></div></a>\
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_5%26rnd%3D205200785' class='union_go_btn'><div></div></a>\
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D4%26l_frm%3DPetit_cg_index_2%26rnd%3D503457161' class='prof_go_btn'><div></div></a>\
</div>\
</div>\
";
} else {
showHtml += "\
<div class='response_area jsOnBtn jsBuyConfView'>\
\
<div class='param_type_01 long'>\
<dl>\
<dt class='item_possession'><span></span></dt>\
<dd>"+ accessory.has_cnt +"</span></dd>\
</dl>\
</div>\
<div id='jsImpossibility'>\
<span class='red'>ぷちマニーが足りません</span>\
<div class='not_buy'>\
<a href='#' class='jsNotBuyBtn jsShopConfirm_close'><div></div></a>\
</div>\
</div>\
</div>\
</div>\
";
}
target.prepend(showHtml);
$('.jsShopConfirm_btn').trigger('click');
$('.jsBuyBtn').on('click', function(){
se_play('se_113');
uiAjaxFunc(accessory.accessory_id);
});
return false;
}
$(document).on('click', '#jsCloseWindowBtn', function(){
$('.jsShopConfirm_close').trigger('click');
return false;
});
$(document).on('click','.union_go_btn',function(){
$('.jsEquipmentLink').trigger('click');
return false;
});
function uiAjaxFunc(itemId){
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_exchange_check%3Fl_frm%3DPetit_cg_index_1%26rnd%3D323956650',
data: {
'accessory_id': itemId
},
dataType: 'json',
})
.done(function(data) {
buyComplete(data);
$('#shop_after_money').text(data.petit_param.money);
$('#user_param_money').text(data.petit_param.money);
});
}
function buyComplete(data){
//alert('購入処理完了');
$('.jsBuyConfView').hide();
$('.jsBuyCompView').show();
$('#jsShopConfirm .window_title').text("購入しました。");
if (typeof(data.petit_param.head_name) === 'string' && data.petit_param.head_name.length > 0){
$('#after_buy_message').show().text(data.petit_param.head_name + "を獲得しました");
} else {
$('#after_buy_message').hide().text("");
}
$('#jsUseMoney').html(String(data.petit_param.money).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,'));
}
$('#jsSwitchBtn').on('click', function(){
var elm = $('#shop_menu .palam');
var elm2 = $('#shop_menu .palam2');
if( elm2.css('display') == 'none' ){
elm.hide();
elm2.show();
}else{
elm2.hide();
elm.show();
}
return false;
});
$('#jsWideviewBtn').on('click', function(){
var elm = $('#jsWideviewBtn');
if( elm.attr('class').indexOf('jsWideview') > -1 ){
$('#shop_menu').addClass('_wide');
$('#jsWideviewBtn').removeClass('jsWideview').addClass('jsSmallview');
}else{
$('#shop_menu').removeClass('_wide');
$('#jsWideviewBtn').removeClass('jsSmallview').addClass('jsWideview');
}
return false;
});
function getPetitStatus(first){
if (typeof(first) !== 'undefined') {
var user_idol_list = $.parseJSON('{"1":{"viewer_id":"158671539","idol_id":"1070","level":"30","exp":"8300","vocal":18732,"dance":16799,"visual":17225,"create_time":"2019-04-06 05:04:27","update_time":"2019-05-29 13:26:32","delete_time":null,"total_param":11850,"idol_info":{"image":"item\/l\/petit_cg\/chara\/1070","idol_id":"1070","idol_name":"\u65e9\u5742\u7f8e\u73b2","short_name":"\u7f8e\u73b2","attribute":"1"},"name":"\u65e9\u5742\u7f8e\u73b2","attribute":"1","idol_message":"\u3053\u306e\u9593\uff64\u4e8b\u52d9\u6240\u306e\uff94\uff82\u3089\u3068\uff79\uff9e\uff70\uff7e\uff9d\u306b\u884c\u3063\u3066\u3055\uff61\u597d\u304d\u306a\uff77\uff6c\uff97\u306e\u306c\u3044\u3050\u308b\u307f\uff64\u53d6\u3063\u3066\u3082\u3089\u3048\u305f\u3093\u3060!","idol_attribute":"1","touch_comment_list":[]},"2":{"viewer_id":"158671539","idol_id":"1109","level":"21","exp":"4148","vocal":2584,"dance":2002,"visual":2098,"create_time":"2019-12-16 20:12:01","update_time":"2022-10-13 15:11:52","delete_time":null,"total_param":6684,"idol_info":{"image":"item\/l\/petit_cg\/chara\/1109","idol_id":"1109","idol_name":"\u671b\u6708\u8056","short_name":"\u8056","attribute":"2"},"name":"\u671b\u6708\u8056","attribute":"2","idol_message":"\u51ac\u304c\u2026\u597d\u304d\u2026\u2026\uff61\u7a7a\u6c17\u304c\u3059\u3093\u3067\u3044\u3066\u2026\u2026\u58f0\u304c\u3068\u304a\u304f\u307e\u3067\u2026\u305a\uff70\u3063\u3068\u9060\u304f\u307e\u3067\u5c4a\u304f\u304b\u3089\u2026\u2026","idol_attribute":"2","touch_comment_list":[]},"3":{"viewer_id":"158671539","idol_id":"1092","level":"25","exp":"5688","vocal":1660,"dance":1645,"visual":1987,"create_time":"2019-09-26 08:17:36","update_time":"2022-10-13 15:11:55","delete_time":null,"total_param":5292,"idol_info":{"image":"item\/l\/petit_cg\/chara\/1092","idol_id":"1092","idol_name":"\u53cc\u8449\u674f","short_name":"\u674f","attribute":"1"},"name":"\u53cc\u8449\u674f","attribute":"1","idol_message":"\uff9a\uff6f\uff7d\uff9d\u306f\u4f55\u304c\u5f97\u610f\u304b\uff64\u3060\u3063\u3066? \u2026\u306f\u3063! \u3082\u3057\u304b\u3057\u3066\u4ed5\u4e8b\u3092\u5897\u3084\u3059\u6c17\u3060\u306a\u3063!? \u305d\u3046\u306f\u3055\u305b\u308b\u304b\uff70!","idol_attribute":"1","touch_comment_list":[]}}');
var data = {
deck_position  : chara(),
idol_attribute : user_idol_list[chara()].idol_attribute,
idol_message   : user_idol_list[chara()].idol_message,
swf_url        : "",
user_idol      : user_idol_list[chara()],
user_param     : $.parseJSON('{"viewer_id":"158671539","money":"1025409","point":"19123","create_time":"2019-04-05 23:09:59","update_time":"2022-12-17 21:45:29","delete_time":null}')
};
setPetitStatus(data);
setIdolMes(1,data.idol_message,data.idol_attribute);
eyeCatch.offCount();
} else {
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_idol_status%3Fl_frm%3DPetit_cg_index_1%26rnd%3D964050331',
dataType: 'json',
data: {
"deck_position": chara()
}
})
.done(function(data) {
if(data.swf_url){
window.location.href = data.swf_url;
return false;
}
setPetitStatus(data);
setIdolMes(1,data.idol_message,data.idol_attribute);
eyeCatch.offCount();
});
}
return false;
}
function setPetitStatus(data){
$('#jsPetitIdolParam_name').text(data.user_idol.name);
$('#jsPetitIdolParam_lv').text(data.user_idol.level);
$('#jsPetitIdolParam_total').text(data.user_idol.total_param);
$('#jsPetitIdolParam_vo').text(data.user_idol.vocal);
$('#jsPetitIdolParam_da').text(data.user_idol.dance);
$('#jsPetitIdolParam_vi').text(data.user_idol.visual);
$('#jsUserParam_money').text(data.user_param.money);
$('#jsUserParam_tcpt').text(data.user_param.point);
if(data.user_idol.attribute){
switch (data.user_idol.attribute){
case '1':
$('#jsPetitIdolParam_name').removeClass('cool passion');
$('#jsPetitIdolParam_name').addClass('cute');
break;
case '2':
$('#jsPetitIdolParam_name').removeClass('cute passion');
$('#jsPetitIdolParam_name').addClass('cool');
break;
case '3':
$('#jsPetitIdolParam_name').removeClass('cute cool');
$('#jsPetitIdolParam_name').addClass('passion');
break;
}
}
return false;
}
$('.menu_tab a').on('click', function(){
$('.menu_tab a').removeClass('_on');
$(this).addClass('_on');
$('.jsTabArea').hide();
$('.' + $(this).attr('name')).show();
if( $(this).hasClass('tab_menu_01') ){
$('#main_screen').css('height','828px').css('background-color','#fff');
}else{
$('#main_screen').css('height','612px').css('background-color','#fff');
}
return false;
});
$('.tabLink').on('click', function(){
$(this).parent().parent().hide();
$(this).parent().parent().parent().children('#jsTabSwitch_' + $(this).data('text') ).show();
return false;
});
$('#jsProfileLinkarea .domChenge').on('click', function(){
$('.profile_panels').hide();
$('#profile_menu').show();
$('.profile_link_area').hide();
$('#profile_main_title').show();
//$('#' + $(this).data('text') ).show();
//backProfile();
//success_load(dataMerge(profile_base[chara()]),++count_index);
return false;
});
$('#jsCoordinate').on('click', function(){
$('#profile_main_title').hide();
$('#profile_coordinate_title').show();
$('#profile_menu').hide();
$('#profile_coordinate').show();
getCoordinateList(0,1);
});
$('#jsCoordinateSort').on('change', function(){
getCoordinateList($(this).val());
});
function getCoordinateList(sortId,no_update){
var type = (typeof(sortId) !== 'undefined') ? sortId : '0';
if (!sortId) {
$('#jsCoordinateSort').val(0);
}
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_coordinate_list%3Fl_frm%3DPetit_cg_index_1%26rnd%3D951315342',
dataType: 'json',
data: {
"type": type,
"deck_position": chara()
}
})
.done(function(data) {
createCoordinateList(data.accessory_list, data.take_off_info);
setIdolMes(4,data.idol_message,data.idol_attribute);
if(no_update === undefined){
createCoordinateGenerationList.init(data.take_off_info);
}
eyeCatch.offCount();
});
return false;
}
function createCoordinateList(accessorys, take_off_info){
var list = $('#jsCoordinateList > ul');
var showHtml = "<ul>";
for (var key in accessorys) {
var row = accessorys[key];
var take_key = "default_"+row.part_name+"_take_off_available";
var tmp = "\
<li>\
<a href='#' data-accessory_id='"+ row.accessory_id +"' data-type='"+ row.part_name +"' data-type_id='"+row.type_id+"' data-take_off='"+ ((!is_null(row[take_key]) && row[take_key]) ? 1 : 0) +"' class='jsCoordinateItem'><img src='"+ row.image +"' width='60' height='60'></a>\
</li>\
";
showHtml += tmp;
}
list.replaceWith(showHtml += '</ul>');
$('.jsCoordinateItem').on('click', function(){
var is_fit_sub_type = 0;
se_play('se_008');
var $obj = $('#jsCoordinateChange');
var type = $(this).data('type');
var accessory_id = $(this).data('accessory_id');
var take_flag = false;
$('.jsCoordinateItem._select').removeClass('_select');
$(this).addClass('_select');
if ($(this).data('take_off')){
take_flag = mc.character[chara()].takeOff(type,accessory_id);
if(take_flag){
is_fit_sub_type = mc.character[chara()]['fit_sub_type'][type] ? 0 : 1;
mc.character[chara()]['fit_sub_type'][type] = is_fit_sub_type;
createCoordinateGenerationList.dataOrganize(0,0,parseInt(petitLocalStrageLoad('position')),0,0,0,0,0,take_flag);
}
}else{
$obj.data(type,accessory_id);
}
ajaxChangeCloth( accessory_id , $(this).data('type_id') , $(this).data('take_off') , take_flag , 1);
return false;
});
}
$('.put_back_btn').on('click', function(){
$('.jsCoordinateItem._select').removeClass('_select');
$(this).addClass('_select');
coordinateFitting({ 'costume':0 , 'head':0 , 'hand': 0 , 'leg' : 0 , subtype_takeoff : mc.character[chara()].fit_sub_type },1);
return false;
});
$('#jsCoordinateChange').on('click', function(){
var data = $('#jsCoordinateChange').data();
if (data) {
coordinateFitting( $.extend(data , { subtype_takeoff : mc.character[chara()].fit_sub_type } ));
createCoordinateGenerationList.update(parseInt(petitLocalStrageLoad('position')));
} else {
return false;
}
});
function coordinateFitting(items,redate){
if ($.isEmptyObject(items)) {
return false;
}
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_coordinate%3Fl_frm%3DPetit_cg_index_1%26rnd%3D300624196',
dataType: 'json',
data: {
"itemid_list": items,
"deck_position": chara()
}
})
.done(function(data) {
$('#jsCoordinateChange').removeData();
mc.character[data.deck_position].fitting = { hair : 0 , costume : 0 , head : 0 , hand : 0 , leg : 0 };
mc.baseChange(data.flash_param_js, data.deck_position , true);
mc.init();
$('.jsCompleteWindow_btn').trigger('click');
$('#completeKind').text('コーディネート');
if(redate === undefined || redate === 0){
}else{
createCoordinateGenerationList.dataOrganize(data.flash_param_js.petit_csv_info_list,0,data.deck_position,0,1,0);
}
});
return false;
}
$('#jsHair').on('click', function(){
$('#profile_main_title').hide();
$('#profile_hair_title').show();
$('#profile_menu').hide();
$('#profile_hair').show();
getHairstyleList();
});
function getHairstyleList(){
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_hair_styling_list%3Fl_frm%3DPetit_cg_index_1%26rnd%3D743576744',
dataType: 'json',
data: {
"deck_position": chara()
}
})
.done(function(data) {
createHairstyleList(data.hair_list);
setIdolMes(4,data.idol_message,data.idol_attribute);
eyeCatch.offCount();
});
return false;
}
function createHairstyleList(hairstyles){
var list = $('#jsHairstyleList > ul');
var showHtml = "<ul class='jsOnBtn'>";
for (var key in hairstyles) {
var row = hairstyles[key];
var tmp = "\
<li>\
<a href='#' data-text='"+ row.hair_id +"' class='jsHairstyleItem'><div>"+ row.hair_name +"</div></a>\
</li>\
";
showHtml += tmp;
if (row.current_flag) {
$('#jsCurrentHairstyle').html(row.hair_name+'<div></div>');
}
}
list.replaceWith(showHtml += '</ul>');
$('.jsHairstyleItem').on('click', function(){
se_play('se_008');
$('.jsHairstyleItem._select').removeClass('_select');
$(this).addClass('_select');
//menu = 4;
ajaxChangeCloth($(this).data('text'));
return false;
});
}
$('#jsHairstyleChange').on('click', function(){
var itemId = $('.jsHairstyleItem' + '._select').data('text');
if (itemId) {
hairstyleFitting(itemId);
} else {
return false;
}
});
function hairstyleFitting(itemId){
if (!itemId) {
return false;
}
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_hair_styling%3Fl_frm%3DPetit_cg_index_1%26rnd%3D76324484',
dataType: 'json',
data: {
"hair_id": itemId,
"deck_position": chara()
}
})
.done(function(data) {
mc.character[data.deck_position].fitting = { hair : 0 , costume : 0 , head : 0 , hand : 0 , leg : 0 };
mc.baseChange(data.flash_param_js, data.deck_position , true);
mc.init();
$('.jsCompleteWindow_btn').trigger('click');
$('#completeKind').text('ヘアスタイル');
});
return false;
}
$('#jsEpisode').on('click', function(){
$('#profile_main_title').hide();
$('#profile_episode_title').show();
$('#profile_menu').hide();
$('#profile_episode').show();
getEpisodeList( petitLocalStrageLoad('idol_id') );
});
function getEpisodeList(idol_id){
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_episode_list%3Fl_frm%3DPetit_cg_index_1%26rnd%3D573166247',
dataType: 'json',
data: {
'idol_id': idol_id
}
})
.done(function(data) {
createEpisodeList(idol_id, data.episode_list);
episodeVoiceFlag(data);
setIdolMes(4,data.idol_message,data.idol_attribute);
eyeCatch.offCount();
});
}
function createEpisodeList(idol_id, episodes){
var list = $('#jsEpisodeList > .ep_list');
if ($.isEmptyObject(episodes)) {
var showHtml = "<div class='ep_list red' style='margin-left:6px;'>開放されているエピソードがありません。</div>";
} else {
var baseUrl = ('https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fpetit_show_episode%2F__idol_ld__%2F__episode__%2Fcoordinate_idol%2F__position__%3Fvoice_flag%3D0%26l_frm%3DPetit_cg_index_1%26rnd%3D456037360');
baseUrl = baseUrl.replace('__idol_ld__', idol_id);
baseUrl = baseUrl.replace('__position__', chara());
var showHtml = "<ul class='ep_list'>";
for (var key in episodes) {
var row = episodes[key];
var episodeUrl = baseUrl.replace('__episode__', row.episode_id);
var tmp = "\
<li>\
<div class='left'>\
<h3>エピソード"+ row.episode_id +"</h3>\
<div>"+ row.episode_name +"</div>\
</div>\
<div class='right'>\
<a href='"+ episodeUrl +"' class='jsEpisodePlayBtn'><div></div></a>\
</div>\
</li>\
";
showHtml += tmp;
}
}
list.replaceWith(showHtml += '</ul>');
}
function episodeVoiceFlag(data){
if(data.episode_list.length && data.episode_list[0].episode_voice == 1) $('#petitEpisodeVoiceFlg').show();
else $('#petitEpisodeVoiceFlg').hide();
}
$(document).on('click', '.jsLessonConfirm_close_sub', function(){
$('.jsLessonConfirm_close').trigger('click');
return false;
});
$(document).on('click', '.jsEpisodePlayBtn', function(){
var voiceSwitch = $('#jsEpisodeVoiceFlag').is(':checked');
var episodeUrl = $(this).attr('href');
if(voiceSwitch) $(this).attr('href', episodeUrl.replace('voice_flag%3D0','voice_flag%3D1'));
else $(this).attr('href', episodeUrl.replace('voice_flag%3D1','voice_flag%3D0'));
se_play('se_022');
});
$(document).on('click', '.buy_continue_btn, .union_go_btn, .prof_go_btn', function(){
se_play('se_022');
});
$(document).on('click', '.jsNotBuyBtn, .jsShopConfirm_close, .jsLessonConfirm_close', function(){
if(se_play_flg) se_play('se_083');
se_play_flg = 1;
});
$('#jsComments').on('click', function(){
getCommentsList();
});
function getCommentsList(){
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_idol_comment_list%3Fl_frm%3DPetit_cg_index_1%26rnd%3D257221238',
dataType: 'json',
data: {
'deck_position': chara()
}
})
.done(function(data) {
if(data.open_comment_list){
updateCommentList.attribute = data.idol_attribute;
updateCommentList.comment_list = data.open_comment_list;
updateCommentList.init();
}else{
updateCommentList.viewNoComments();
}
setIdolMes(5,data.idol_message,data.idol_attribute);
eyeCatch.offCount();
});
}
function setIdolMes(no,mes,attribute){
if(no == 1){
$('#jsIdolCommentMain').text(mes);
} else if(no == 2) {
$('.jsIdolMes').text(mes);
} else if(no == 3) {
$('.jsIdolMes').text(mes);
} else if(no == 4) {
$('.jsIdolMes').text(mes);
} else if(no == 5) {
$('.jsIdolMes').text(mes);
}
switch (attribute){
case '1':
$('.jsFukidashiColor').removeClass('cool passion');
$('.jsFukidashiColor').addClass('cute');
break;
case '2':
$('.jsFukidashiColor').removeClass('cute passion');
$('.jsFukidashiColor').addClass('cool');
break;
case '3':
$('.jsFukidashiColor').removeClass('cute cool');
$('.jsFukidashiColor').addClass('passion');
break;
}
}
$('#jsOpenTrg').on('click', function(){
var elm = $(this);
if( elm.attr('class') == 'jsOpenBtn' ){
$('.jsSlideArea').addClass('_slideIn');
setTimeout(function(){
elm.removeClass('jsOpenBtn').addClass('jsCloseBtn');
}, 300);
} else {
$('.jsSlideArea').removeClass('_slideIn');
setTimeout(function(){
elm.removeClass('jsCloseBtn').addClass('jsOpenBtn');
}, 300);
}
return false;
});
$('#side_menu_switch').on('click', function(){
$(this).toggleClass('menuOn');
$('#main_menu').toggleClass('_slideIn');
return false;
});
$('#jsLessonBtn').on('click', function(){
$('#lesson_menu').toggleClass('_slideIn');
return false;
});
$('#ftime').on('change', function(){
showCompleteLesson($(this).data('object'));
$(this).removeData();
mc.character[chara()].stopLesson();
});
$('#index_action_btn').on('click', function(){
if( $(this).hasClass('_off') ) return false;
else se_play('se_145');
});
$('#jsLessonComplete').on('click', '.jsLessonAgainMenu', function(){
$('.jsLessonComplete_close').trigger('click');
$('#jsLessonConfirm').empty();
if($(".efficiency").eq(0).text() == "") {
$('#main_screen').css('height','492px').css('background-color','#d0975c');
}
else {
$('#main_screen').css('height','537px').css('background-color','#d0975c');
}
$('#lesson_menu').show();
var data = $('#lesson_menu').data();
createLessonConfirm(data);
createLessonList(window.lesson_list, 0,chara());
//mc.init(data.user_lesson.deck_position);
return false;
});
$("li[name^='tab_']").click(function(){
$("div[class^='area_tab_']").hide();
$(".area_"+$(this).attr("name")).show();
$("li[name^='tab_']").removeClass("selected");
$(this).attr("class", this.className+" selected");
return false;
});
if( !parseInt($ftime.val())){ 
var date = new Date();
$ftime.val(Math.floor(Date.parse(date)/1000));
}
createCoordinateGenerationList = {SETTINGS: {accessorys_list : [],provisional_accessorys_list : [],subtype_list : []},init: function(takeOffInfo){if(Object.keys(this.SETTINGS.accessorys_list).length < 1){this.SETTINGS.accessorys_list[1] = $.parseJSON('{"head_2_30070":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F30070","accessory_name":"\u30cf\u30fc\u30c8\u306e\u773c\u5e2f\u30fb\u7f8e\u73b2","explanation":"\u7f8e\u73b2\u304a\u6c17\u306b\u5165\u308a\u306e\u773c\u5e2f\u3067\u3059\u3002<br>\u30cf\u30fc\u30c8\u304c\u53ef\u611b\u3044\u3060\u308d\u30c3!","type_id":"3"},"costume_2_23903":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F23903","accessory_name":"\u30d1\u30f3\u30ad\u30c3\u30b7\u30e5\u30fb\u30d3\u30fc\u30b9\u30c8","explanation":"\u53cd\u9aa8\u7cbe\u795e\u306e\u6ea2\u308c\u308b\u3001\u30ed\u30c3\u30af\u3067\u30d1\u30f3\u30af\u306a\u8863\u88c5\u3067\u3059\u3002<br>\u7518\u304f\u898b\u3066\u308b\u30e4\u30c4\u306f\u3001\u3072\u3063\u304b\u304f\u305e\u30c3!","type_id":"2"},"hand_2_43054":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F43054","accessory_name":"\u91ce\u7403\u30b0\u30ed\u30fc\u30d6\u3068\u30d0\u30c3\u30c8","explanation":"\u91ce\u7403\u306e\u30b0\u30ed\u30fc\u30d6\u3068\u30d0\u30c3\u30c8\u3067\u3059\u3002<br>\u8d70\u653b\u5b88\u4e09\u62cd\u5b50\u63c3\u3048\u3066\u3001\u6311\u3081\u9802\u70b9!","type_id":"4"},"leg_2_51079":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F51079","accessory_name":"\u30c7\u30a3\u30a2\u30c1\u30e7\u30b3\u30ec\u30fc\u30c8\u30fb\u30ea\u30dc\u30f3","explanation":"\u5c0f\u3055\u306a\u8594\u8587\u304c\u30dd\u30a4\u30f3\u30c8\u306e\u3001\u30ea\u30dc\u30f3\u578b\u30a2\u30f3\u30af\u30ec\u30c3\u30c8\u3067\u3059\u3002<br>\u8db3\u5143\u3082\u624b\u3092\u629c\u304b\u306a\u3044\u306e\u304c\u3001\u30aa\u30c8\u30ca\u306e\u6d41\u5100\u266a","type_id":"5"}}');this.SETTINGS.provisional_accessorys_list[1] = $.parseJSON('{"head_2_30070":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F30070","accessory_name":"\u30cf\u30fc\u30c8\u306e\u773c\u5e2f\u30fb\u7f8e\u73b2","explanation":"\u7f8e\u73b2\u304a\u6c17\u306b\u5165\u308a\u306e\u773c\u5e2f\u3067\u3059\u3002<br>\u30cf\u30fc\u30c8\u304c\u53ef\u611b\u3044\u3060\u308d\u30c3!","type_id":"3"},"costume_2_23903":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F23903","accessory_name":"\u30d1\u30f3\u30ad\u30c3\u30b7\u30e5\u30fb\u30d3\u30fc\u30b9\u30c8","explanation":"\u53cd\u9aa8\u7cbe\u795e\u306e\u6ea2\u308c\u308b\u3001\u30ed\u30c3\u30af\u3067\u30d1\u30f3\u30af\u306a\u8863\u88c5\u3067\u3059\u3002<br>\u7518\u304f\u898b\u3066\u308b\u30e4\u30c4\u306f\u3001\u3072\u3063\u304b\u304f\u305e\u30c3!","type_id":"2"},"hand_2_43054":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F43054","accessory_name":"\u91ce\u7403\u30b0\u30ed\u30fc\u30d6\u3068\u30d0\u30c3\u30c8","explanation":"\u91ce\u7403\u306e\u30b0\u30ed\u30fc\u30d6\u3068\u30d0\u30c3\u30c8\u3067\u3059\u3002<br>\u8d70\u653b\u5b88\u4e09\u62cd\u5b50\u63c3\u3048\u3066\u3001\u6311\u3081\u9802\u70b9!","type_id":"4"},"leg_2_51079":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F51079","accessory_name":"\u30c7\u30a3\u30a2\u30c1\u30e7\u30b3\u30ec\u30fc\u30c8\u30fb\u30ea\u30dc\u30f3","explanation":"\u5c0f\u3055\u306a\u8594\u8587\u304c\u30dd\u30a4\u30f3\u30c8\u306e\u3001\u30ea\u30dc\u30f3\u578b\u30a2\u30f3\u30af\u30ec\u30c3\u30c8\u3067\u3059\u3002<br>\u8db3\u5143\u3082\u624b\u3092\u629c\u304b\u306a\u3044\u306e\u304c\u3001\u30aa\u30c8\u30ca\u306e\u6d41\u5100\u266a","type_id":"5"}}');this.SETTINGS.subtype_list[1] = $.parseJSON('{"head_2_30070":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F30070","accessory_name":"\u30cf\u30fc\u30c8\u306e\u773c\u5e2f\u30fb\u7f8e\u73b2","explanation":"\u7f8e\u73b2\u304a\u6c17\u306b\u5165\u308a\u306e\u773c\u5e2f\u3067\u3059\u3002<br>\u30cf\u30fc\u30c8\u304c\u53ef\u611b\u3044\u3060\u308d\u30c3!","type_id":"3"}}');this.SETTINGS.accessorys_list[2] = $.parseJSON('{"costume_2_20109":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F20109","accessory_name":"\u30b0\u30ea\u30fc\u30f3\u30cb\u30c3\u30c8\u30b3\u30fc\u30c7\u30fb\u8056","explanation":"\u7dd1\u8272\u306e\u30cb\u30c3\u30c8\u304c\u30aa\u30b7\u30e3\u30ec\u306a\u8056\u306e\u79c1\u670d\u3067\u3059\u3002<br>\u30de\u30d5\u30e9\u30fc\u3068\u30bf\u30a4\u30c4\u3067\u3001\u5bd2\u3044\u65e5\u3082\u3078\u3063\u3061\u3083\u3089\u3002","type_id":"2"}}');this.SETTINGS.provisional_accessorys_list[2] = $.parseJSON('{"costume_2_20109":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F20109","accessory_name":"\u30b0\u30ea\u30fc\u30f3\u30cb\u30c3\u30c8\u30b3\u30fc\u30c7\u30fb\u8056","explanation":"\u7dd1\u8272\u306e\u30cb\u30c3\u30c8\u304c\u30aa\u30b7\u30e3\u30ec\u306a\u8056\u306e\u79c1\u670d\u3067\u3059\u3002<br>\u30de\u30d5\u30e9\u30fc\u3068\u30bf\u30a4\u30c4\u3067\u3001\u5bd2\u3044\u65e5\u3082\u3078\u3063\u3061\u3083\u3089\u3002","type_id":"2"}}');this.SETTINGS.accessorys_list[3] = $.parseJSON('{"costume_2_20092":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F20092","accessory_name":"\u306f\u305f\u307e\u3051T\u30b7\u30e3\u30c4\u30fb\u674f","explanation":"\u674f\u306e\u540d(\u8ff7)\u8a00T\u30b7\u30e3\u30c4\u3002<br>\u50cd\u3044\u305f\u3089\u8ca0\u3051\u3002","type_id":"2"}}');this.SETTINGS.provisional_accessorys_list[3] = $.parseJSON('{"costume_2_20092":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F20092","accessory_name":"\u306f\u305f\u307e\u3051T\u30b7\u30e3\u30c4\u30fb\u674f","explanation":"\u674f\u306e\u540d(\u8ff7)\u8a00T\u30b7\u30e3\u30c4\u3002<br>\u50cd\u3044\u305f\u3089\u8ca0\u3051\u3002","type_id":"2"}}');}this.windowGeneration(this.SETTINGS.accessorys_list[parseInt(petitLocalStrageLoad('position'))]);},update: function(chara_line){delete this.SETTINGS.accessorys_list[chara_line];this.SETTINGS.accessorys_list[chara_line] = false;this.SETTINGS.accessorys_list[chara_line] = {};for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){this.SETTINGS.accessorys_list[chara_line][key] = this.SETTINGS.provisional_accessorys_list[chara_line][key];}},redate: function(chara_line){delete this.SETTINGS.provisional_accessorys_list[chara_line];this.SETTINGS.provisional_accessorys_list[chara_line] = false;this.SETTINGS.provisional_accessorys_list[chara_line] = {};for (var key in this.SETTINGS.accessorys_list[chara_line]){this.SETTINGS.provisional_accessorys_list[chara_line][key] = this.SETTINGS.accessorys_list[chara_line][key];}},dataOrganize: function(data,sub_type,chara_line,type_id,restore,item_id,data_img_path,sub_type_info,take_info){if(restore === undefined || restore === 0){if(take_info === undefined){if(sub_type === undefined){}else{if(sub_type.head != null){var defaultEquipment = Object.keys(sub_type.head);}}for (var key in data){if(key.indexOf(item_id) != -1){var tap_item = data[key];var tap_item_key = key;}}var is_equipment_type = 0;for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(type_id == this.SETTINGS.provisional_accessorys_list[chara_line][key]['type_id']){is_equipment_type = 1;}}var is_equipment_item_id = 0;for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(key.indexOf(item_id) != -1){is_equipment_item_id = 1;}}if (defaultEquipment){if(defaultEquipment == tap_item_key){for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(type_id == this.SETTINGS.provisional_accessorys_list[chara_line][key]['type_id']){delete this.SETTINGS.provisional_accessorys_list[chara_line][key];}}this.SETTINGS.provisional_accessorys_list[chara_line][tap_item_key] = tap_item;}else{if (is_equipment_type == 1){var is_change_ok = 0;for (var key in data_img_path){if(tap_item_key == key){if(data_img_path[key].indexOf('default_sub_type_id') != -1){is_change_ok = 2;}else if(data_img_path[key].indexOf('sub_type_id') != -1){is_change_ok = 1;}}}var key_name = 0;var key_name_flag = 0;for (var key in this.SETTINGS.subtype_list[chara_line]){key_name = key;}for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(key == key_name){key_name_flag = 1;}}if(!is_equipment_item_id){for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(type_id == this.SETTINGS.provisional_accessorys_list[chara_line][key]['type_id']){if((defaultEquipment != key || is_change_ok == 1) && key.indexOf('30070') == -1){delete this.SETTINGS.provisional_accessorys_list[chara_line][key];}this.SETTINGS.provisional_accessorys_list[chara_line][tap_item_key] = tap_item;if(key_name_flag == 0 && type_id == 3 && is_change_ok == 0){if(mc.character[chara_line].fit_sub_type.head == 0){this.SETTINGS.provisional_accessorys_list[chara_line][key_name] = this.SETTINGS.subtype_list[chara_line][key_name];}}}}}}else{this.SETTINGS.provisional_accessorys_list[chara_line][tap_item_key] = tap_item;}}}else{if (is_equipment_type == 1){for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(type_id == this.SETTINGS.provisional_accessorys_list[chara_line][key]['type_id']){delete this.SETTINGS.provisional_accessorys_list[chara_line][key];this.SETTINGS.provisional_accessorys_list[chara_line][tap_item_key] = tap_item;}}}else{this.SETTINGS.provisional_accessorys_list[chara_line][tap_item_key] = tap_item;}}}else{var key_name = 0;for (var key in this.SETTINGS.subtype_list[chara_line]){key_name = key;}if (take_info == 99){for (var key in this.SETTINGS.provisional_accessorys_list[chara_line]){if(3 == this.SETTINGS.provisional_accessorys_list[chara_line][key]['type_id']){delete this.SETTINGS.provisional_accessorys_list[chara_line][key];}}}if(mc.character[chara_line].fit_sub_type.head == 0){this.SETTINGS.provisional_accessorys_list[chara_line][key_name] = this.SETTINGS.subtype_list[chara_line][key_name];}else{delete this.SETTINGS.provisional_accessorys_list[chara_line][key_name];}}}else{if (restore == 99) var chara_line = 1;delete this.SETTINGS.accessorys_list[chara_line];delete this.SETTINGS.provisional_accessorys_list[chara_line];this.SETTINGS.accessorys_list[chara_line] = false;this.SETTINGS.provisional_accessorys_list[chara_line] = false;this.SETTINGS.accessorys_list[chara_line] = {};this.SETTINGS.provisional_accessorys_list[chara_line] = {};for (var key in data){this.SETTINGS.accessorys_list[chara_line][key] = data[key];this.SETTINGS.provisional_accessorys_list[chara_line][key] = data[key];}}this.windowGeneration(this.SETTINGS.provisional_accessorys_list[chara_line]);},windowGeneration: function(data){if(data === undefined){return false;}$('#jsCoordinateDefaultArea > ul').empty();var list = $('#jsCoordinateDefaultArea > ul');var showHtml = "<ul>";for (var key in data) {var row = data[key];var img_src = row.image_path + ".png";var tmp = "<li><img src='"+ img_src +"' class='accessory_img'><div class='accessory_title'>" + row.accessory_name + "</div><div class='accessory_detail'>" + row.explanation + "</div></li>";showHtml += tmp;}list.replaceWith(showHtml += '</ul>');}};
function count_down_timer(element, data){
clearInterval(timer);
var time_data = new Object(),
ftime = parseInt($ftime.val());
time_data.element = $(element),
time_data.remaining_time = data.remaining_time,
time_data.line_delay = false,
time_data.deck_position = data.deck_position,
time_data.delay = Math.abs(onload_time - ftime) < 3600 && ftime ? 0 : onload_time - ftime, 
time_data.lesson_id = data.lesson_id,
time_data.level_up_flag =data.level_up_flag,
time_data.completed_time = data.completed_time;
refreshTime(time_data);
timer = setInterval(function(){ refreshTime(time_data) },1000);
}
function refreshTime(time_data){
var now = new Date();
now = Math.floor(now / 1000);
var tgtTime = (time_data.completed_time-delay_time) + time_data.delay;
var remainTime = tgtTime - now;
if(time_data.line_delay === false){
var server_remain_str = time_data.remaining_time.split(/[- :]/);
var server_remain_int = (server_remain_str[0]*3600) + (server_remain_str[1]*60) + parseInt(server_remain_str[2]);
time_data.line_delay = remainTime - server_remain_int;
}
remainTime = remainTime - time_data.line_delay;
var hour = Math.floor(remainTime/3600),
min = Math.floor( (remainTime%3600)/60 ),
sec = Math.floor(remainTime%60);
if(remainTime>=0){
time_data.element.text((hour<10?"0"+hour:hour)+':'+(min<10?"0"+min:min)+':'+(sec<10?"0"+sec:sec));
}else if(remainTime<=-1){
time_data.element.text('00:00:00');
clearInterval(timer);
getLessonList(1);
}
}
function makeLessonAttribute(flag){
var random_no = flag ? 4 : (Math.floor( Math.random()*3 )+1);
return random_no;
}
function textCut(text){
count = 0;
for(i=0; i<text.length; i++){
n = escape(text.charAt(i));
var code = text.charCodeAt(i);
if((code >= 0x0 && code < 0x81) || (code == 0xf8f0) || (code >= 0xff61 && code < 0xffa0) || (code >= 0xf8f1 && code < 0xf8f4) || n.length < 4) count+=1;
else count+=2;
if (count > 8) {
return text.substr(0, i) + '...';
}
}
return text;
}
$("#jsItemPopup").ou();
var ajax_data = null;
$('#use_item_btn').on('click', function(){
getPetitItemAjax();
return false;
});
function getIdolId() {
var idol_id = parseInt($('#_target .jsIdolListPalam_id').val());
if( window.mc != void 0 && mc.character[chara()].idol_id != void 0) idol_id = parseInt(mc.character[chara()].idol_id);
if ( ! idol_id) {
idol_id = petitLocalStrageLoad('idol_id');
}
return idol_id;
}
function getPetitItemAjax() {
var idol_id = getIdolId();
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_use_item_select%3Fl_frm%3DPetit_cg_index_1%26rnd%3D566864199',
dataType: 'json',
data: {
'idol_id': idol_id
}
})
.done(function(data) {
createItemSelect(data);
})
.fail(function(data) {
$('.jsPopUp_close').trigger('click');
});
}
function createItemSelect(data) {
$('.jsPopUp_close').trigger('click');
var target = $('#jsItemTop');
ajax_data = data;
var item_list = data.item_list;
var itemHtml = "";
var loop_num = 0;
$('#item_id_at_item_select').val('');
for (var item_id in item_list) {
var item = item_list[item_id];
if (item.avail_num > 0 && $('#item_id_at_item_select').val().length == 0) {
$('#item_id_at_item_select').val(item.item_id);
}
var petit_exp_str = '';
if (item.petit_exp > 0) {
petit_exp_str = 'ぷちExp + ' + item.petit_exp;
}
var tech_pt_str = '';
if (item.tech_pt > 0) {
tech_pt_str = 'テクニカルpt + ' + item.tech_pt;
}
var both_flg = false;
if (item.petit_exp > 0 && item.tech_pt > 0) {
both_flg = true
}
itemHtml += "<li class='item'>";
if (item.avail_num > 0) {
itemHtml += "<a href='#' class='item_select_anchor' data-item_id='" + item.item_id + "'>";
}
itemHtml += "\
<div class='title'>\
" + petit_exp_str + (both_flg ? "<br />" : "") + tech_pt_str + "\
</div>\
<div class='content'>\
<img src='" + item.image_url + "' width='80' height='80' alt='" + item.name + "' id='item_select_" + item.item_id + "' /><br />\
× " + item.number + "個\
</div>";
if (item.avail_num > 0) {
itemHtml += "</a>";
}
itemHtml += "</li>";
loop_num++;
}
var showHtml = "\
<div class='jsPopWindow'>\
<div class='window_title'>どのアイテムを使用しますか？</div>\
<a href='#' class='close_btn jsItemPopup_close_sub'><div></div></a>\
<div class='in_block no-border'>\
<div class='popup_contents_item_select'>\
<ul class='jsOnBtn'>" + itemHtml + "\
</ul>\
</div>\
<div style='clear:left;'></div>\
</div>\
<div class='response_area jsOnBtn' id='jsChooseItemNum'>\
<div class='left_area'>\
<select id='select_use_item_num' name='use_num'>\
</select>\
</div>\
<div class='right_area'>\
<a href='#' id='use_item_confirm' class='jsUseBtn' rel='1'><div></div></a>\
</div>\
<p id='noItemMsg' class='red' style='display:none'>使用できるアイテムがありません。<br>※アイテムはイベント等で獲得できます。</p>\
</div>\
<p id='maxExpMsg' class='red' style='display:none; padding: 0 15px;margin-bottom: 5px;'>※Lvが最大のため、ぷちExp獲得アイテムを使用できません</p>\
</div>\
";
target.html(showHtml);
updateBorderItemSelect();
changeUseItemNumOption();
$('#jsItemPopup > div').hide();
$('#jsItemTop').show();
if (data.user_idol.is_max_lv) {
$('#maxExpMsg').show();
} else {
$('#maxExpMsg').hide();
}
$('.jsItemPopup_btn').trigger('click');
}
$(document).on('click', '.jsItemPopup_close_sub', function(){
$('.jsItemPopup_close').trigger('click');
se_play('se_083');
if ($('#_target .jsIdolListPalam_id').val() > 0) {
if ($('#is_use_item_result_popup').val()) {
window.location.reload();
}
}
return false;
});
function updateBorderItemSelect() {
if (ajax_data.item_list != null) {
for (var item_id in ajax_data.item_list) {
var item = ajax_data.item_list[item_id];
if ($('#item_id_at_item_select').val() == item.item_id) {
$('#item_select_' + item.item_id).addClass('thick_border');
$('#item_select_' + item.item_id).removeClass('thin_border');
}
else {
$('#item_select_' + item.item_id).addClass('thin_border');
$('#item_select_' + item.item_id).removeClass('thick_border');
}
}
}
}
$(document).on('click', 'a.item_select_anchor', function(){
$('#item_id_at_item_select').val($(this).data('item_id'));
se_play('se_005');
updateBorderItemSelect();
changeUseItemNumOption();
return false;
});
function changeUseItemNumOption() {
var selected_item_id = parseInt($('#item_id_at_item_select').val());
var inner_html = '';
if (ajax_data.item_list != null && selected_item_id > 0) {
for (var item_id in ajax_data.item_list) {
var item = ajax_data.item_list[item_id];
if (item.item_id != selected_item_id) {
continue;
}
for (var j = 0; j < item['select_number_array'].length; j++) {
var use_num = item['select_number_array'][j];
inner_html += '<option value="' + use_num + '">' + use_num + '個</option>';
}
}
$('#select_use_item_num').html(inner_html);
$('#noItemMsg').hide();
$('#jsChooseItemNum > div').show();
}
else {
$('#jsChooseItemNum > div').hide();
$('#noItemMsg').show();
}
}
$(document).on('click', '#use_item_confirm', function(){
var idol_id = getIdolId();
var item_id = parseInt($('#item_id_at_item_select').val());
var use_num = parseInt($('#select_use_item_num').val());
se_play('se_022');
if ( ! item_id) {
return false;
}
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_use_item_confirm%3Fl_frm%3DPetit_cg_index_1%26rnd%3D861779459',
dataType: 'json',
data: {
'idol_id': idol_id,
'item_id': item_id,
'use_num': use_num
}
})
.done(function(data) {
createItemConfirm(data);
return false;
})
.fail(function(data) {
$('.jsItemPopup_close').trigger('click');
return false;
});
return false;
});
function createItemConfirm(data) {
var target = $('#jsItemConf');
var effectHtml = '';
if (data.gain_petit_exp > 0) {
effectHtml += 'ぷちExp + ' + data.gain_petit_exp;
}
if (data.gain_petit_exp > 0 && data.gain_tech_pt > 0) {
effectHtml += '<br />';
}
if (data.gain_tech_pt > 0) {
effectHtml += 'テクニカルpt + ' + data.gain_tech_pt;
}
var showHtml = "\
<input type='hidden' value='' id='csrf_token'>\
<input type='hidden' value='' id='use_item_num'>\
<div class='jsPopWindow'>\
<div class='window_title'>" + data.user_idol.short_name + "に" + data.item.name + "を使用しますか？</div>\
<a href='#' class='close_btn jsItemPopup_close_sub'><div></div></a>\
<div class='in_block no-border'>\
<div class='popup_contents_item_confirm'>\
<div class='image_area'>\
<img src='"+ data.item.image_url +"' width='80' height='80'>\
</div>\
<div class='data_area'>\
<h3>効果</h3>\
<div class='effect'>" + effectHtml + "</div>\
<h3 class='m-Top5'>所持数</h3>\
<div class='effect'>\
" + data.item.before_number + " ⇒ " + data.item.after_number + "個\
</div>\
</div>\
</div>\
</div>\
<div class='response_area jsOnBtn'>\
<div class='left_area'>\
<a href='#' class='jsNotBuyBtn' id='cancel_use_item_confirm'><div></div></a>\
</div>\
<div class='right_area'>\
<a href='#' id='use_item_exec' class='jsBuyBtn' rel='1'><div></div></a>\
</div>\
</div>\
</div>\
";
target.html(showHtml);
$('#csrf_token').val(data.csrf_token_value);
$('#csrf_token').attr({ 'name' : data.csrf_token_name });
$('#use_item_num').val(data.use_num);
$('#jsItemPopup > div').hide();
$('#jsItemConf').show();
}
$(document).on('click', '#use_item_exec', function(){
var idol_id = getIdolId();
var item_id = parseInt($('#item_id_at_item_select').val());
var use_num = parseInt($('#use_item_num').val());
var csrf_token_key = $('#csrf_token').attr('name');
var csrf_token_value = $('#csrf_token').val();
var ajax_param = {
'idol_id': idol_id,
'item_id': item_id,
'use_num': use_num
}
ajax_param[csrf_token_key] = csrf_token_value;
se_play('se_113');
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_use_item_exec%3Fl_frm%3DPetit_cg_index_1%26rnd%3D326328581',
dataType: 'json',
data: ajax_param
})
.done(function(data) {
createItemResult(data);
return false;
})
.fail(function(data) {
$('.jsItemPopup_close').trigger('click');
return false;
});
return false;
});
$(document).on('click', '#cancel_use_item_confirm', function(){
se_play('se_083');
$('#jsItemPopup > div').hide();
$('#jsItemTop').show();
return false;
});
function createItemResult(data) {
var target = $('#jsItemRes');
var effectHtml = '';
if (data.gain_petit_exp > 0) {
effectHtml += '<span class="blue">ぷちExp:</span> <span class="yellow">+' + data.gain_petit_exp + '</span>';
}
if (data.gain_petit_exp > 0 && data.gain_tech_pt > 0) {
effectHtml += '<br />';
}
if (data.gain_tech_pt > 0) {
effectHtml += '<span class="blue">テクニカルpt:</span> <span class="yellow">+' + data.gain_tech_pt + '</span>';
}
var lvupHtml = '';
if (data.is_lvup) {
lvupHtml = "\
<h3 class='m-Top5'>Lvアップ</h3>\
<div class='effect' style='font-weight:normal;font-size:11px;color:#2e3d4a'>\
<span class='blue'>Lv:</span>"+ data.after_lv +"/30(<span class='yellow'>+"+ (data.after_lv - data.before_lv) +"</span>) \
<span class='blue'>Vo:</span>"+ data.after_param.vo +"(<span class='yellow'>+"+ (data.after_param.vo - data.before_param.vo) +"</span>)<br>\
<span class='blue'>Da:</span>"+ data.after_param.da +"(<span class='yellow'>+"+ (data.after_param.da - data.before_param.da) +"</span>) \
<span class='blue'>Vi:</span>"+ data.after_param.vi +"(<span class='yellow'>+"+ (data.after_param.vi - data.before_param.vi) +"</span>)\
</div>\
";
} else if (data.next_lv_petit_exp) {
lvupHtml = "\
<h3 class='m-Top5'>Lvアップ</h3>\
<div class='effect' style='font-weight:normal;font-size:11px;color:#2e3d4a'>\
<span class='blue'>次のLvアップまで:</span> <span class='yellow'>"+ data.next_lv_petit_exp +"</span>\
</div>\
";
} else if (data.after_tech_pt) {
lvupHtml = "\
<h3 class='m-Top5'>所持テクニカルpt</h3>\
<div class='effect'>\
<span class='blue'>"+ data.before_tech_pt +"pt</span> ⇒ <span class='yellow'>"+ data.after_tech_pt +"pt</span>\
</div>\
";
}
var showHtml = "\
<input type='hidden' value='1' id='is_use_item_result_popup'>\
<div class='jsPopWindow'>\
<div class='window_title'>" + data.user_idol.short_name + "に" + data.item.name + "を使用しました</div>\
<a href='#' class='close_btn jsItemPopup_close_sub'><div></div></a>\
<div class='in_block no-border'>\
<div class='popup_contents_item_confirm'>\
<div class='image_area'>\
<img src='"+ data.item.image_url +"' width='80' height='80'>\
</div>\
<div class='data_area'>\
<h3>獲得</h3>\
<div class='effect'>" + effectHtml + "</div>\
" + lvupHtml + "\
</div>\
</div>\
</div>\
<div class='response_area jsOnBtn' style='padding-bottom:0'>\
<div class='jsOnBtn'>\
<a href='#' class='jsContinuationItemUseBtn' data-text='2' id='continue_use_item'>\
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_6%26rnd%3D284402917' id='use_item_result_popup_cls' class='jsToTopBtn jsLinkAct' data-text='1'></a>\
</div>\
</div>\
</div>\
";
target.html(showHtml);
$('#jsItemPopup > div').hide();
$('#jsItemRes').show();
nextLevelInput(data.next_lv_petit_exp);
}
$(document).on('click', '#continue_use_item', function(){
getPetitItemAjax();
se_play('se_022');
return false;
});
$(document).on('click', '#use_item_result_popup_cls', function(e){
e.preventDefault();
se_play('se_022');
$('.jsItemPopup_close').trigger('click');
screenChange(1);
});
});
window.addEventListener('load', function(){
menu = new Menu();
mc = new MakeCharacter($.parseJSON('{"1":{"attribute":"1","body_type":"2","breast_size":"3","short_name":"\u7f8e\u73b2","image_url_list":{"expression_1070":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/expression\/1070.js","hair_13903":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/hair\/13903.js","head_2_30070":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/head\/2\/30070.js","costume_2_23903":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/costume\/2\/23903.js","hand_2_43054":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/hand\/2\/43054.js","leg_2_51079":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/leg\/2\/51079.js"},"sub_type_list":{"head":{"head_2_30070":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/head\/2\/30070.js"},"hand":null,"leg":null},"take_sub_type":{"head":0,"hand":0,"leg":0},"petit_csv_info_list":{"head_2_30070":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F30070","accessory_name":"\u30cf\u30fc\u30c8\u306e\u773c\u5e2f\u30fb\u7f8e\u73b2","explanation":"\u7f8e\u73b2\u304a\u6c17\u306b\u5165\u308a\u306e\u773c\u5e2f\u3067\u3059\u3002<br>\u30cf\u30fc\u30c8\u304c\u53ef\u611b\u3044\u3060\u308d\u30c3!","type_id":"3"},"costume_2_23903":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F23903","accessory_name":"\u30d1\u30f3\u30ad\u30c3\u30b7\u30e5\u30fb\u30d3\u30fc\u30b9\u30c8","explanation":"\u53cd\u9aa8\u7cbe\u795e\u306e\u6ea2\u308c\u308b\u3001\u30ed\u30c3\u30af\u3067\u30d1\u30f3\u30af\u306a\u8863\u88c5\u3067\u3059\u3002<br>\u7518\u304f\u898b\u3066\u308b\u30e4\u30c4\u306f\u3001\u3072\u3063\u304b\u304f\u305e\u30c3!","type_id":"2"},"hand_2_43054":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F43054","accessory_name":"\u91ce\u7403\u30b0\u30ed\u30fc\u30d6\u3068\u30d0\u30c3\u30c8","explanation":"\u91ce\u7403\u306e\u30b0\u30ed\u30fc\u30d6\u3068\u30d0\u30c3\u30c8\u3067\u3059\u3002<br>\u8d70\u653b\u5b88\u4e09\u62cd\u5b50\u63c3\u3048\u3066\u3001\u6311\u3081\u9802\u70b9!","type_id":"4"},"leg_2_51079":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F51079","accessory_name":"\u30c7\u30a3\u30a2\u30c1\u30e7\u30b3\u30ec\u30fc\u30c8\u30fb\u30ea\u30dc\u30f3","explanation":"\u5c0f\u3055\u306a\u8594\u8587\u304c\u30dd\u30a4\u30f3\u30c8\u306e\u3001\u30ea\u30dc\u30f3\u578b\u30a2\u30f3\u30af\u30ec\u30c3\u30c8\u3067\u3059\u3002<br>\u8db3\u5143\u3082\u624b\u3092\u629c\u304b\u306a\u3044\u306e\u304c\u3001\u30aa\u30c8\u30ca\u306e\u6d41\u5100\u266a","type_id":"5"}},"petit_csv_sub_type_info_list":{"head_2_30070":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F30070","accessory_name":"\u30cf\u30fc\u30c8\u306e\u773c\u5e2f\u30fb\u7f8e\u73b2","explanation":"\u7f8e\u73b2\u304a\u6c17\u306b\u5165\u308a\u306e\u773c\u5e2f\u3067\u3059\u3002<br>\u30cf\u30fc\u30c8\u304c\u53ef\u611b\u3044\u3060\u308d\u30c3!","type_id":"3"}},"idol_id":"1070"},"2":{"attribute":"2","body_type":"2","breast_size":"3","short_name":"\u8056","image_url_list":{"expression_1109":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/expression\/1109.js","hair_10109":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/hair\/10109.js","costume_2_20109":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/costume\/2\/20109.js"},"sub_type_list":{"head":null,"hand":null,"leg":null},"take_sub_type":{"head":0,"hand":0,"leg":0},"petit_csv_info_list":{"costume_2_20109":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F20109","accessory_name":"\u30b0\u30ea\u30fc\u30f3\u30cb\u30c3\u30c8\u30b3\u30fc\u30c7\u30fb\u8056","explanation":"\u7dd1\u8272\u306e\u30cb\u30c3\u30c8\u304c\u30aa\u30b7\u30e3\u30ec\u306a\u8056\u306e\u79c1\u670d\u3067\u3059\u3002<br>\u30de\u30d5\u30e9\u30fc\u3068\u30bf\u30a4\u30c4\u3067\u3001\u5bd2\u3044\u65e5\u3082\u3078\u3063\u3061\u3083\u3089\u3002","type_id":"2"}},"petit_csv_sub_type_info_list":[],"idol_id":"1109"},"3":{"attribute":"1","body_type":"2","breast_size":"3","short_name":"\u674f","image_url_list":{"expression_1092":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/expression\/1092.js","hair_10092":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/hair\/10092.js","costume_2_20092":"..\/..\/..\/..\/idolmaster\/js\/petit_cg\/costume\/2\/20092.js"},"sub_type_list":{"head":null,"hand":null,"leg":null},"take_sub_type":{"head":0,"hand":0,"leg":0},"petit_csv_info_list":{"costume_2_20092":{"image_path":"https:\/\/sp.pf-img-a.mbga.jp\/12008305\/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2Fitem%2Fl%2Fpetit_cg%2F20092","accessory_name":"\u306f\u305f\u307e\u3051T\u30b7\u30e3\u30c4\u30fb\u674f","explanation":"\u674f\u306e\u540d(\u8ff7)\u8a00T\u30b7\u30e3\u30c4\u3002<br>\u50cd\u3044\u305f\u3089\u8ca0\u3051\u3002","type_id":"2"}},"petit_csv_sub_type_info_list":[],"idol_id":"1092"}}'));
}, false);
function is_null(value){
return value === void 0;
}
function firstLoaded(){
if(!loading['main'] || !loading['window']|| !loading['lesson']) return;
petitLocalStrageSave('idol_id', mc.character[chara()].idol_id );
screenRefresh();
}
var createCoordinateGenerationList = createCoordinateGenerationList || {};
function ajaxChangeCloth(itemId , type_id , takeoff , take_flag , list_update_flag){
if (!cloth_ready) return;
cloth_ready = false;
if(is_null(takeoff)) var takeoff = false;
if(is_null(take_flag)) var take_flag = false;
var type_name = type_keys[is_null(type_id)?1:type_id];
var current_chara = chara();
var self = this;
if (menu.getNow() == 3){
this.data = { 'accessory_id' : itemId, 'type': type_id, 'deck_position':current_chara , 'shop_flag' : 1 };
}else{
if (is_null(type_id)){
this.data = { 'hair_id' : itemId, 'type': 1, 'deck_position':current_chara };
}else if (takeoff && take_flag){
var tempCloth = $.extend({ }, mc.character[current_chara].image_url_list );
var body_type = mc.character[current_chara].body_type == 4 ? 1 : mc.character[current_chara].body_type;
var parts = type_keys[type_id]+'_'+body_type+'_'+itemId;
if(mc.character[current_chara].fit_sub_type[type_keys[type_id]]){
if(!is_null(tempCloth[parts])){
delete tempCloth[parts];
}
}else{
if(is_null(tempCloth[parts]) && !is_null(mc.character[current_chara].sub_type_list[type_keys[type_id]][parts]) ){
tempCloth[parts] = mc.character[current_chara].sub_type_list[type_keys[type_id]][parts];
}
}
$animation.empty();
mc.deletePex(current_chara);
mc.setClothData(tempCloth);
return;
}else{
this.data = { 'accessory_id' : itemId, 'type': type_id, 'deck_position':current_chara ,'shop_flag' : 0 };
}
}
$.ajax({
type: 'post',
url : 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_try_on%3Fl_frm%3DPetit_cg_index_1%26rnd%3D999551427',
data : self.data,
dataType : 'json',
cache : false,
success : function(data){
if(takeoff && !take_flag){
if(mc.character[current_chara].sub_flag && mc.character[current_chara].sub_flag == itemId){
mc.character[current_chara]['fit_sub_type'][type_keys[type_id]] = mc.character[current_chara]['fit_sub_type'][type_keys[type_id]] ? 0 : 1;
mc.character[current_chara].sub_flag = 0;
}else{
mc.character[current_chara].sub_flag = itemId;
}
$('#jsCoordinateChange').data(type_keys[type_id],0);
}else{
mc.character[current_chara].sub_flag = 0;
}
mc.baseChange(data.current_list, current_chara);
if ( is_null(mc.character[current_chara].fitting) ){
mc.setClothData(data.fitting_list.image_url_list);
}else{
if (type_name == 'hair'){
fitting_name = type_name+'_'+itemId;
}else{
fitting_name = type_name+'_'+(mc.character[current_chara].body_type == 4 ? 1 : mc.character[current_chara].body_type)+'_'+itemId;
}
var obj = new Object();
obj[fitting_name] = data.fitting_list.image_url_list[fitting_name];
if( mc.character[current_chara].fit_sub_type[type_name] && obj[fitting_name].indexOf('default_sub_type') > -1){
mc.character[current_chara].fitting[type_name] = 0;
}else{
mc.character[current_chara].fitting[type_name] = obj;
}
mc.setClothData(data.fitting_list.image_url_list);
}
if (list_update_flag !== undefined){
if(takeoff && !take_flag){
createCoordinateGenerationList.dataOrganize(data.fitting_list.petit_csv_info_list,0,parseInt(petitLocalStrageLoad('position')),0,0,0,0,0,99);
}else{
createCoordinateGenerationList.dataOrganize(data.fitting_list.petit_csv_info_list,data.fitting_list.sub_type_list,parseInt(petitLocalStrageLoad('position')),type_id,0,itemId,data.fitting_list.image_url_list,data.fitting_list.petit_csv_sub_type_info_list);
}
}
}
});
}
function EyeCatch(){
this.element = $('#jsEyeCatch');
var count = -1;
var motion = -1;
this.setCount = function(num){
count = parseInt(num);
this.element.show();
};
this.offCount = function(){
if(count < 0) return;
if(--count == 0){
this.element.hide();
count = -1;
}
};
this.get = function(){
return count;
}
this.setMotion = function(num){
motion = parseInt(num);
};
this.offMotion = function(){
if(motion < 0) return;
if(--motion == 0){
motion = -1;
}
};
this.getMotion = function(){
return motion;
}
};
EyeCatch.prototype.on = function (){
this.element.show();
}
EyeCatch.prototype.off = function (){
this.element.hide();
}
function CurrentCharacter (){
var position = 0;
if (!position && petitLocalStrageLoad('position')){ position = parseInt(petitLocalStrageLoad('position')); }
else if (!position){ position = 1; petitLocalStrageSave('position', position ); }
else{ petitLocalStrageSave('position', position ); }
this.set = function(num){
position = num;
petitLocalStrageSave('position', position );
return position;
}
this.get = function(){
return position;
}
}
function Menu(){
var now =  4;
if(window.localStorage){
if (now == 1 && localStorage.getItem("unitView") == "1" && 1 && 1){
now = 5;
}
}
this.getNow = function(){
return now;
};
this.setNow = function(select){
now = select;
return select;
};
this.canvasNum = function(){
var return_no = 5;
switch(now){
case 2 :
return_no = 1;
break;
case 3 :
case 4 :
return_no = 2; 
break;
}
return return_no;
};
};
function MakeCharacter (data){
if(data === void 0) return;
this.count = 0;
this.cloth_data = new Object();
this.character = new Object();
for (var i in data){
if(!Object.keys(data[i]).length) continue;
this.character[i] = new PetitCharacter(i);
$.extend(this.character[i] ,data[i]);
}
if( is_null(this.character[chara()]) ){
currentCharacter.set(1);
}
this.init();
};
MakeCharacter.prototype.init = function(position){
var current_position = position === void 0 ? chara() : position;
if (menu.getNow() == 5){
this.clothMerge();
}else{
this.setClothData(this.character[current_position].image_url_list);
}
};
MakeCharacter.prototype.clothMerge = function(){
var image_url_list = new Object();
for (var i in this.character){
$.extend(image_url_list, this.character[i].image_url_list);
}
this.setClothData(image_url_list);
};
MakeCharacter.prototype.setClothData = function(clothData){
var tempLength = { 'list' : Object.keys(clothData) , 'loaded' : 0 , 'cloth' : clothData };
for (var key in clothData ){
if(this.cloth_data[key] === void 0){
if(window[key] !== void 0){
this.imageAlready(key, window[key] , tempLength);
}else{
this.loadImageJs(clothData[key] ,key , tempLength);
}
}else{
this.replaceReady(tempLength);
}
}
};
MakeCharacter.prototype.loadImageJs = function(url, script_name, tempLength){
var self = this;
var image_script  = document.createElement('script');
image_script.onload = function(){
self.imageAlready(script_name, window[script_name] , tempLength);
}
image_script.src = url;
document.getElementsByTagName('head')[0].appendChild(image_script);
};
MakeCharacter.prototype.imageAlready = function(script_name, alreay_image_data ,tempLength){
var tempCloth = new Array();
var length = Object.keys(alreay_image_data).length;
for (var i in alreay_image_data){
this.imageToReplace(script_name, alreay_image_data[i] , i , length , tempLength , tempCloth);
}
};
MakeCharacter.prototype.imageToReplace = function(script_name, merge_data , index, length , tempLength , tempCloth){
var img = new Image();
var self = this;
img.onload = function(){ 
tempCloth.push({ 'name' : index , 'img' : img });
if(length == tempCloth.length){
self.cloth_data[script_name] = new Array();
self.cloth_data[script_name] = self.cloth_data[script_name].concat(tempCloth);
self.replaceReady(tempLength);
}
}
img.src = merge_data;
document.getElementById('prefetch').appendChild(img);
};
MakeCharacter.prototype.replaceReady = function(tempLength){
if ( ++tempLength.loaded == tempLength.list.length){
$('#prefetch').empty();
this.ready(tempLength.cloth);
}
};
MakeCharacter.prototype.ready = function(cloth){
if(!loading.window){
loading.window = true;
firstLoaded();
return false;
}
$animation.empty();
for(var i in this.character){
this.deletePex(i);
if( menu.getNow() == 5 ){
this.character[i].init(void 0);
this.character[i].active.set(5);
}else if(i == chara() ){
this.character[i].init(is_null(this.character[i].fitting) ? cloth : this.character[i].getFitting(cloth) );
this.character[i].active.set(menu.canvasNum());
}else{
this.character[i].active.set(false);
}
}
};
MakeCharacter.prototype.deletePex = function(index){
if (!this.character[index].api) return;
this.character[index].api.destroy();
delete this.character[index].api;
delete this.character[index].pex
this.character[index].api = false;
this.character[index].pex = false;
};
MakeCharacter.prototype.baseChange = function(data, position , change_flag){
if( this.character[position].short_name == data.short_name && is_null(change_flag) || !change_flag && this.character[position].short_name == data.short_name ) return;
delete this.character[position].image_url_list;
if(this.character[position].fitting !== void 0) this.character[position].fitting = { hair : 0 , costume : 0 , head : 0 , hand : 0 , leg : 0 };
$.extend(this.character[position],data);
}
MakeCharacter.prototype.finished = function(){
if(++this.count == Object.keys(this.character).length){
$('#jsEyeCatch').hide();
this.count = 0;
}
};
function PetitCharacter(position){
this.pex = false;
this.api = false;
this.position = position;
this.shortpants = false;
var active = false;
this.active = { set : function(flag){ active = flag; }, get : function(){ return active; } };
this.lesson = false;
this.sub_flag = 0;
};
PetitCharacter.prototype.isShortpants = function(url){
if(url.indexOf('costume') > -1){
if(url.indexOf('shortpants') > -1) this.shortpants = true;
else this.shortpants = false;
}
};
PetitCharacter.prototype.init = function(image_url_list){
var image_url_list = $.extend({ }, is_null(image_url_list) ? this.image_url_list : image_url_list);
for (var name in image_url_list){
this.isShortpants(image_url_list[name]);
}
var replace = new Array();
for (var name in image_url_list){
for ( var i in mc.cloth_data[name]){
if(name.indexOf('costume') > -1){
if(this.breast_size == 2 || this.breast_size == 3){
if(mc.cloth_data[name][i].name  == 'replace_breast_L') continue;
}
if(this.breast_size == 1 || this.breast_size == 3){
if(mc.cloth_data[name][i].name  == 'replace_breast_S') continue;
}
}
if(name.indexOf('leg') > -1){
if(this.shortpants){
if (mc.cloth_data[name][i].name  == 'replace_item_foot_L_back' ) continue;
}else{
if (mc.cloth_data[name][i].name  == 'replace_item_foot_L_front' ) continue;
}
}
replace.push(mc.cloth_data[name][i]);
}
}
this.setOption(replace);
};
PetitCharacter.prototype.setOption = function(replace_data){
var chrome_app_flg = "";
var andapp_flg = "";
var ratio = window.devicePixelRatio >= 1.5 || chrome_app_flg === "1" || andapp_flg === "1" ? 2:1;
var option = {
enableButton: false,
partialDraw : getPexPartialDraw(),
delayEval : false,
transparent : true,
touchEvent : false,
replace : replace_data,
operation : { lighter_tgt : "lighter" },
width : 320 * ratio
};
this.pexRun(option);
};
PetitCharacter.prototype.pexRun = function(option){
var self = this;
if (menu.canvasNum() == 5){
this.pex = new Pex( top_petit , menu.getNow() == 1 ? animation0 : 'animation_ch'+this.position , option );
}else{
this.pex = new Pex( menu.canvasNum() == 2 ? change_cloth_motion : main_motion , 'animation'+menu.canvasNum() , option );
}
this.api = this.pex.getAPI();
this.api.ready(function(){
var setVariable = { small_character_flg : ( self.body_type == 2 ? 1: 0 ) , big_character_flg : (self.body_type == 4 ? 1: 0 ) , cheek_type : (self.body_type == 3 ? 2 : 1 ) };
if(menu.getNow() == 5){
setVariable['swf_type'] = self.position;
}else if ( menu.getNow() == 1 ){
setVariable['swf_type'] = 0;
}
cloth_ready = true;
switch(menu.getNow()){
case 1 :
setVariable['swf_type'] = 0;
break;
case 2 :
setVariable['initial_state'] = zoom ? 0 : 1;
break;
case 5 : 
setVariable['swf_type'] = self.position;
break;
}
self.api.setVariables('',setVariable);
if ( menu.getNow() == 2 ){
self.runLesson();
}
eyeCatch.offCount();
});
};
PetitCharacter.prototype.getFitting = function(cloth){
var cloth_data = $.extend({ }, is_null(cloth) ? this.image_url_list : cloth );
for(var index in cloth_data){
var type = index.replace(/[\d_]/g,'');
var fitting_data = this.fitting[type];
if(typeof fitting_data == 'object' || this.fit_sub_type[type] && cloth_data[index].indexOf('default_sub_type') > -1) delete cloth_data[index];
}
for (var index in this.fitting){
if(this.fit_sub_type[index] && this.fitting[index]!=0 && this.fitting[index][Object.keys(this.fitting[index])[0]].indexOf('default_sub_type')>-1 ) continue;
$.extend(cloth_data, this.fitting[index]);
}
for (var index in this.sub_type_list){
if(this.sub_type_list[index] !== null && !this.fit_sub_type[index]){
var sub_data = this.sub_type_list[index];
var sub_key = Object.keys(sub_data)[0];
var sub_url = sub_data[sub_key];
var sub_type_id = getSubType(sub_url);
if(is_null(cloth_data[sub_key])){
var fitting_sub_data = this.fitting[index];
if (typeof fitting_sub_data =='object'){
var fitting_key = Object.keys(fitting_sub_data)[0];
var fitting_url = fitting_sub_data[fitting_key];
var fitting_sub_type_id = getSubType(fitting_url);
if(!fitting_sub_type_id || sub_type_id != fitting_sub_type_id){
$.extend(cloth_data,sub_data);
}
}
}
}
}
return cloth_data;
};
PetitCharacter.prototype.takeOff = function(type,accessory_id){
var take_flag = true;
var cloth = this.getFitting();
for(var i in cloth){
if(i.indexOf(type)>-1 && cloth[i].indexOf('sub_type') > -1 && cloth[i].indexOf('default_sub_type')==-1){
var sub_name = Object.keys(this.sub_type_list[type])[0];
if(getSubType(this.sub_type_list[type][sub_name]) == getSubType(cloth[i])){
take_flag = false;
}
}
}
return take_flag;
};
PetitCharacter.prototype.runLesson = function(){
var action = false;
switch(parseInt(this.lesson)){
case 1:
action = 'lesson_visual';
break;
case 2:
action = 'lesson_dance';
break;
case 3:
action = 'lesson_vocal';
break;
case 4:
action = 'lesson_hell';
break;
default:
action = 'default_back';
break;
}
this.api.callActions('', action);
}
PetitCharacter.prototype.stopLesson = function(){
clearInterval(timer);
this.lesson = false;
$('#jsLessonRemainingTime').text('00:00:00');
this.api.callActions('', 'default_back' );
}
$('#zoom_btn_area a').on('click', function(){
if($(this).hasClass('_select')) return false;
$('#zoom_btn_area a').toggle();
mc.character[chara()].api.setVariable('','initial_state',zoom);
zoom = Math.abs(zoom -1);
mc.character[chara()].api.callActions('/', $(this).data('text') );
return false;
});
PetitCharacter.prototype.getBodytype = function(){
return (this.body_type == 4 ? 1 : this.body_type);
}
$('#index_action_btn').on('click',function(){
if( $(this).hasClass('_off') || typeof motion_list=='object' && typeof motion_list[chara()] =='undefined' && menu.getNow() != 5 || eyeCatch.getMotion() > -1) return false;
if ( menu.getNow() == 5){
var motion_random = Math.ceil(Math.random()*3);
for(var i in mc.character){
mc.character[i].api.setVariable('', 'append_motion_idx' , motion_random);
}
setTimeout(function(){
for(var i in mc.character){
mc.character[i].api.callActions('/', 'append_motion');
}
eyeCatch.setMotion(Object.keys(mc.character).length);
},10);
}else{
var motion_random = Math.floor(Math.random()*(Object.keys(motion_list[chara()]).length));
mc.character[chara()].api.setVariable('','append_motion_idx', motion_list[chara()][motion_random] );
setTimeout(function(){
mc.character[chara()].api.callActions('/', 'append_motion' );
eyeCatch.setMotion(1);
},10);
}
return false;
});
$('#cc-left, #cc-right , #cc-center').click(function(){
se_play('se_113');
if(change_click) return false; 
if($(this).hasClass('cc__icon-unselected')){
change_click = true;
changeCharacter($(this).data('type'));
createCoordinateGenerationList.redate($(this).data('type'));
setTimeout(function(){
change_click = false;
},1000);
}else if($(this).hasClass('cc__icon-none')){
change_click = true;
document.location = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fdeck_edit_top%3Fl_frm%3DPetit_cg_index_2%26rnd%3D743457687';
}
return false;
});
function changeCharacter(selected_position){
if (is_null(mc.character[selected_position].idol_id)) return false;
currentCharacter.set(selected_position);
petitLocalStrageSave('idol_id', mc.character[selected_position].idol_id );
screenRefresh(menu.getNow());
return true;
}
function getSubType(url){
if(typeof url != 'string') return false;
var back = false;
var temp_url = url.split('sub_type_id');
if(temp_url[1] === void 0) return back;
if(temp_url[1].slice(0,1)=='='){
back = temp_url[1].slice(1,2);
}else if(temp_url[1].slice(0,1) =='%'){
back = temp_url[1].slice(3,4);
}
return parseInt(back);
}
</script>
<script src="../../../../idolmaster/js/area_slide.js"></script>
<div id='prefetch' style='display:none;'></div>
<footer>
<div class="line_idolmaster"></div>
<a href="#top" id="toPageTop" class="mypage_under"><div></div></a>
<div class="t-Cnt">
&copy;T.K. THE IDOLM@STER&trade; &amp; &copy;BNEI
</div>
</footer>
</div>
<div id="mainPopUpMenu">
<a href="#" class="close_btn mainPopUpMenu_close se_009"><div></div></a>
<div id="popup_menu" class="jsOnBtn">
<div class="title"></div>
<div class="in_block no-border">
<div class="double_menu">
<div class="left_area">
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fview_page%3D3%26l_frm%3DPetit_cg_index_3%26rnd%3D912970514' class="popup_shop_btn jsLinkAct se_022" data-text="3" id='link-petit-shop'><div></div></a>
</div>
<div class="right_area">
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fgacha_info%3Fl_frm%3DPetit_cg_index_1%26rnd%3D2902791' class="popup_gacha_btn se_022"><div></div></a>
</div>
</div>
</div>
<ul class="static_menu_list">
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fdeck_edit_top%3Fl_frm%3DPetit_cg_index_3%26rnd%3D882452069' class="popup_menu_07 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_7%26rnd%3D388282826' class="popup_menu_08 jsEquipmentLink se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fpetit_exchange_list%2Fmedal%3Fl_frm%3DPetit_cg_index_1%26rnd%3D433733098' class="popup_menu_01 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Funion%3Fl_frm%3DPetit_cg_index_1%26rnd%3D607172675' class="popup_menu_04 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Finfo%3Fl_frm%3DPetit_cg_index_1%26rnd%3D157203233' class="popup_menu_05 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fidol_list%3Fl_frm%3DPetit_cg_index_1%26rnd%3D249082420' class="popup_menu_06 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fstorage_accessory_list%2F0%2F1%3Fl_frm%3DPetit_cg_index_1%26rnd%3D474039925' class="popup_menu_11 se_022"><div></div></a></li>
<li><a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fsnapshot%3Fl_frm%3DPetit_cg_index_1%26rnd%3D478338752' class="popup_menu_12 se_022"><div></div></a></li>
<li class="line"></li>
<li class="title_block"><div>設定</div></li>
<li><a href="#" class="popup_menu_09 se_022" id="edit_unit_name_btn"><div></div></a></li>
<li><a href="#" class="popup_menu_10 se_022" id="edit_background_btn"><div></div></a></li>
<li class="line"></li>
</ul>
<div>
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fmypage%3Fl_frm%3DPetit_cg_index_3%26rnd%3D283200362' class="popup_menu_mypage se_002"><div></div></a>
</div>
</div>
</div>
<a href="#" class="editUnitName_btn" style="display:none;"><div></div></a>
<a href="#" class="editBackground_btn" style="display:none;"><div></div></a>
<input type="hidden" id='csrf_token' name="csrf_token_name" value="csrf_token_value">
<div id="editUnitName">
<div class="jsPopWindow jsOnBtn">
<div class="window_title">ユニット名変更</div>
<a href="#" class="close_btn jsPopUp_close editUnitName_close se_009"><div></div></a>
<div class="title"></div>
<div class="in_block no-border t-Cnt">
<span id="edit_petit_unit_name_error" style="color: red;"></span><br />
<input type="text" id="petit_unit_name" name="petit_unit_name" value="Individuals" class="m-Btm10">
</div>
<div class="response_area">
<div class="right_area" style="width:100%; flort:none;">
<a href='#' id="edit_unit_name_exec" class="jsEquipmentBtn se_002"><div></div></a>
</div>
</div>
<div style="color: black; padding: 1em;">
※ユニット名は全角14文字までで入力してください。<br />
※半角カナは全角カナとして反映されます。<br />
※絵文字は使用できません。<br />
※本名、メールアドレス、電話番号などの個人情報や個人の特定に繋がる情報の入力はお控えください。<br />
※ユニット名変更後、5秒以内に再度ユニット名変更を行うことはできません。<br />
</div>
</div>
</div>
<a href="#" class="editUnitNameResult_btn" style="display:none;"><div></div></a>
<div id="editUnitNameResult">
<div class="jsPopWindow jsOnBtn">
<div class="window_title">ユニット名変更</div>
<a href="#" class="close_btn jsPopUp_close editUnitNameResult_close se_009"><div></div></a>
<div class="in_block no-border t-Cnt red">
<p class="m-Btm5 jsAfterUnitName" style="color:#000000;"></p>
<p>ユニット名を変更しました</p>
</div>
<div class="response_area">
<a href='#' class="editUnitNameResult_close width_close_btn se_002"><div></div></a>
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_8%26rnd%3D9455884' class="top_go_btn se_002"><div></div></a>
</div>
</div>
</div>
<div id="editBackground">
<div class="jsPopWindow jsOnBtn">
<div class="window_title">背景変更</div>
<a href="#" class="close_btn jsPopUp_close editBackground_close se_009"><div></div></a>
<div class="in_block no-border t-Cnt area-slide flagAndroid" style="position: relative;">
<div class="background_list move-area flagAndroid" id="jsBackgroundList" >
<div></div>
</div>
</div>
<div class="response_area">
<div class="right_area" style="width:100%; flort:none;">
<a href='#' id="edit_background_exec" class="jsEquipmentBtn se_002"><div></div></a>
</div>
<input type="hidden" id="select_background_id" value="">
</div>
</div>
</div>
<a href="#" class="editBackgroundResult_btn" style="display:none;"><div></div></a>
<div id="editBackgroundResult">
<div class="jsPopWindow jsOnBtn">
<div class="window_title">背景変更</div>
<a href="#" class="close_btn jsPopUp_close editBackgroundResult_close se_009"><div></div></a>
<div class="in_block no-border t-Cnt red">
背景を変更しました
</div>
<div class="response_area">
<a href='#' class="editBackgroundResult_close width_close_btn se_002"><div></div></a>
<a href='https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_9%26rnd%3D953215368' class="top_go_btn se_002"><div></div></a>
</div>
</div>
</div>
<script>
$(function(){
$("#mainPopUpMenu").ou();
$("#pinyaSearchPopup").ou();
$("#editUnitName").ou();
$("#editUnitNameResult").ou();
$("#editBackground").ou();
$("#editBackgroundResult").ou();
$('.jsEquipmentLink').on('click', function(){
var petitEquipmentUrl = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fequipment_edit_top%2FjsUrlEquipment%3Fl_frm%3DPetit_cg_index_1%26rnd%3D923108556';
var petitIdolId = petitLocalStrageLoad('idol_id');
if( petitIdolId ) window.location.href = petitEquipmentUrl.replace('jsUrlEquipment', petitIdolId);
else window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_10%26rnd%3D523003467';
return false;
});
$('.jsTech_boardLink').on('click', function(){
var petitTech_boardUrl = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Ftech_board%2FjsUrlTech%3Fl_frm%3DPetit_cg_index_1%26rnd%3D472935608';
var petitIdolId = petitLocalStrageLoad('idol_id');
if( petitIdolId ) window.location.href = petitTech_boardUrl.replace('jsUrlTech', petitIdolId);
else window.location.href = 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%3Fl_frm%3DPetit_cg_index_11%26rnd%3D918600075';
return false;
});
var onBtnElem = $('.jsOnBtn a, .jsOnBtn input, .jsOnBtn label');
onBtnElem.on('touchstart mousedown',function(){
$(this).addClass('_hover');
$(this).children('.jsOnElm').addClass('_hover');
}).on('touchend mouseup mouseleave',function(){
$(this).removeClass('_hover');
$(this).children('.jsOnElm').removeClass('_hover');
});
$('#edit_unit_name_btn').on('click', function(){
$.ajax({
type: 'GET',
url: '../../../../idolmaster/petit_cg/ajax_get_show_unit_data',
dataType: 'json',
data: {}
})
.done(function(data) {
$('#petit_unit_name').val(data.petit_unit_name);
$('#csrf_token').attr('name', data.csrf_token_name);
$('#csrf_token').attr('value', data.csrf_token_value);
$('.mainPopUpMenu_close').trigger('click');
$('.editUnitName_btn').trigger('click');
});
return false;
});
$('#edit_unit_name_exec').on('click', function(){
var petit_unit_name  = $('#petit_unit_name').val();
var csrf_token_name  = $('#csrf_token').attr('name');
var csrf_token_value = $('#csrf_token').val();
var data_hash = {};
data_hash['petit_unit_name'] = petit_unit_name;
data_hash[csrf_token_name] = csrf_token_value;
$.ajax({
type: 'POST',
url: '../../../../idolmaster/petit_cg/ajax_edit_unit_name',
dataType: 'json',
data: data_hash
})
.done(function(data) {
if (data.error_no == null) {
$('.jsAfterUnitName').html(data.petit_unit_name);
$('.editUnitName_close').trigger('click');
$('.editUnitNameResult_btn').trigger('click');
} else {
if (data.error_no == 1) {
$('#edit_petit_unit_name_error').html('ユニット名が長すぎます。');
} else if (data.error_no == 2) {
$('#edit_petit_unit_name_error').html('ユニット名を指定してください。');
} else if (data.error_no == 3) {
$('#edit_petit_unit_name_error').html('ユニット名が不正です。');
}
$('#csrf_token').attr('name', data.csrf_token_name);
$('#csrf_token').attr('value', data.csrf_token_value);
}
});
return false;
});
var selectBackground = function(selectObj, background_id){
$('.show').removeClass('show');
if (background_id > 0) {
$('#select_background_id').val($('#background_img_' + background_id).data('background_id'));
} else {
$('#select_background_id').val($(selectObj).data('background_id'));
}
$('.selecter_bg').eq(background_id -1).addClass('show');
}
$('#edit_background_btn').on('click', function(){
$.ajax({
type: 'GET',
url: '../../../../idolmaster/petit_cg/ajax_get_show_unit_data',
dataType: 'json',
data: {}
})
.done(function(data) {
var baseUrl = 'https://sp.pf-img-a.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2F__background_id__.jpg%3Fv%3D19700101090000';
var showHtml = "<ul style='padding-left: 5px;'>";
if(Object.keys(data.bg_list).length > 6){
$('.background_list').addClass('extend').parent().css('height', 220);
}else{
$('.background_list').removeClass('extend').parent().css('height', 'auto');
}
$.each(data.bg_list,function(){
var url = baseUrl.replace('__background_id__', this.path + 'thumbnail/' + this.bg_id );
var tmp = "\
<li style='float: left; margin: 0px 5px 5px 0px;'>\
<div style='position: relative;'>\
<div class='selecter_bg'></div>\
<img src='"+ url +"' style='height:90px; width:90px;' id='background_img_"+ this.bg_id +"' class='background_img' data-background_id='"+ this.bg_id +"'>\
</div>\
</li>\
";
showHtml += tmp;
});
$('#jsBackgroundList > div').replaceWith(showHtml + '</ul>');
$('.background_img').on('click', function(){
selectBackground(this, $(this).data('background_id'));
return false;
});
$('#select_background_id').val(data.background_id);
$('#csrf_token').attr('name', data.csrf_token_name);
$('#csrf_token').attr('value', data.csrf_token_value);
$('.mainPopUpMenu_close').trigger('click');
$('.editBackground_btn').trigger('click');
selectBackground(this, data.background_id);
});
return false;
});
$('#edit_background_exec').on('click', function(){
var background_id = $('#select_background_id').val();
var csrf_token_name  = $('#csrf_token').attr('name');
var csrf_token_value = $('#csrf_token').val();
var data_hash = {};
data_hash['bg_id'] = background_id;
data_hash[csrf_token_name] = csrf_token_value;
if (document.getElementById("jsEyeCatch") != null) {
try{
var eyeCatch = new EyeCatch();
eyeCatch.on();
}catch(e){ }
}
$.ajax({
type: 'POST',
url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fpetit_cg%2Fajax_edit_background%3Fl_frm%3DPetit_cg_index_1%26rnd%3D29301500',
dataType: 'json',
data: data_hash
})
.done(function(data) {
var baseUrl = "https://sp.pf-img-a.mbga.jp/12008305/?guid=ON&amp;url=http%3A%2F%2Fmobamas.net%2Fidolmaster%2Fimage_sp%2F__background_id__.jpg%3Fv%3D19700101090000";
var bgData = data.bg_list[data.background_id];
var backGroundUrl = baseUrl.replace('__background_id__', bgData.path + 'long/' + bgData.bg_id);
if (document.getElementById("animation_bg") != null) {
$('#animation_bg').attr('src',backGroundUrl);
$('#animation_bg').one("load", function(){
$('.editBackgroundResult_btn').trigger('click');
if (document.getElementById("jsEyeCatch") != null && eyeCatch != void 0) {
eyeCatch.off();
}
});
} else {
$('.editBackgroundResult_btn').trigger('click');
}
});
$('.editBackground_close').trigger('click');
return false;
});
})
function toggleMenu() {
if ($('#mainPopUpMenu').css('display') === 'block') {
$('.mainPopUpMenu_close').trigger('click');
se_play('se_009');
} else {
$('.mainPopUpMenu_btn').trigger('click');
se_play('se_006');
}
}
</script>
<script src="../../../../idolmaster/js/area_slide.js"></script>
<script>
window._tarminal = {
'native_app_flg': false,
'android_app_flg': false,
'ios_app_flg': false,
'shell_app_flg': false};
</script>
<div id="mbga-pf-footer">
<div class="mbga-pf-footer-container odd-lines mbga-pf-footer-white">
<ul>
	<li class="mbga-pf-footer-list">
		<div class="mbga-pf-fotter-content">
			<a class="mbga-pf-footer-arrow" href="https://sp.mbga.jp/_grp_view?g=32095227">
				<span class="mbga-pf-footer-caption">公式サークル</span>
			</a>
		</div>
	</li>
</ul>
</div>
<div id="mbga-pf-footer-navbar">
	<ul class="mbga-pf-box-h">
		<li id="mbga-pf-footer-navbar-icon-grid" class="mbga-pf-footer-li">
			<a class="mbga-pf-footer-a mbga-pf-footer-home-w" href="https://sp.mbga.jp/?_from=globalfooter">
				<span class="mbga-pf-footer-txt">ホーム</span>
			</a>
		</li>
		<li id="mbga-pf-footer-navbar-icon-mypage" class="mbga-pf-footer-li">
			<a class="mbga-pf-footer-a mbga-pf-footer-mypage-w" href="https://sp.mbga.jp/_my0?_from=globalfooter">
				<span class="mbga-pf-footer-txt">マイページ</span>
			</a>
		</li>
		<li id="mbga-pf-footer-navbar-icon-mygame" class="mbga-pf-footer-li">
			<a class="mbga-pf-footer-a mbga-pf-footer-mygame-w" href="https://sp.mbga.jp/_game_my_top?_from=globalfooter">
				<span class="mbga-pf-footer-txt">マイゲーム</span>
			</a>
		</li>
		<li id="mbga-pf-footer-navbar-icon-notification" class="mbga-pf-footer-li">
			<a class="mbga-pf-footer-a mbga-pf-footer-game-w" href="https://sp.mbga.jp/_game_top?_from=globalfooter">
				<span class="mbga-pf-footer-txt">ゲーム</span>
			</a>
		</li>
	</ul>
</div>
<script type="text/javascript" charset="UTF-8">
(function() {
document.addEventListener('DOMContentLoaded', function() {
	var list = document.getElementsByClassName('mbga-pf-footer-li');
	var i = 0, l = list.length;
	for (; i < l; i++) {
		var elem = list[i];
		elem.addEventListener('touchstart', function(e) {
			e.currentTarget.className = e.currentTarget.className.replace(/$/, ' mbga-pf-tapped');
		});
		elem.addEventListener('touchend', function(e) {
			e.currentTarget.className = e.currentTarget.className.replace(/ mbga-pf-tapped/, '');
		});
		elem.addEventListener('touchmove', function(e) {});
	}
});
})();
</script>
</div>
</body>
</html>
